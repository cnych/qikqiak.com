<!DOCTYPE html>
<html lang="zh">
  <head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">


  <title>ä½¿ç”¨ GitHub Actions è‡ªåŠ¨åŒ–æ„å»º Golang åº”ç”¨-é˜³æ˜çš„åšå®¢|Kubernetes|Istio|Prometheus|Python|Golang|äº‘åŸç”Ÿ</title>
  <meta property="og:title" content="ä½¿ç”¨ GitHub Actions è‡ªåŠ¨åŒ–æ„å»º Golang åº”ç”¨" />
  <meta name="twitter:title" content="ä½¿ç”¨ GitHub Actions è‡ªåŠ¨åŒ–æ„å»º Golang åº”ç”¨" />

  <meta name="description" content="GitHub å‰ä¸€æ®µæ—¶é—´æ¨å‡ºäº†è‡ªå®¶çš„è‡ªåŠ¨åŒ–æ„å»ºå·¥å…·ï¼šGitHub Actionsï¼Œä¸è¿‡ç›®å‰è¿˜æ²¡æœ‰å¼€æ”¾æ³¨å†Œï¼Œåªèƒ½é€šè¿‡ç”³è¯·ç­‰å¾…å®˜æ–¹å®¡æ ¸ã€‚æˆ‘ç¬¬ä¸€æ—¶é—´å°±æäº¤äº†ç”³è¯·ï¼Œç°åœ¨å·²ç»å®¡æ ¸é€šè¿‡äº†ï¼Œæ‰€ä»¥ç¬¬ä¸€æ—¶é—´ä½“éªŒäº†GitHub Actionsçš„åŠŸèƒ½ï¼Œæ€»ä½“æ„Ÿå—æ˜¯ Travis CI ä¹‹ç±»çš„å·¥å…·åº”è¯¥ç°åœ¨åœ¨å¢™è§’ç‘Ÿç‘Ÿå‘æŠ–å§ ğŸ˜„ï¼Ÿ
GitHub Actionså…è®¸æ„å»ºä¸€ä¸ªå®Œæ•´çš„ CI/CD Pipelineï¼Œä¸ GitHub ç”Ÿæ€ç³»ç»Ÿæ·±åº¦é›†æˆï¼Œè€Œæ— éœ€ä½¿ç”¨ Travis CI æˆ–è€… Circle CI ç­‰ç¬¬ä¸‰æ–¹æœåŠ¡ï¼Œå¯¹äºå¼€æºé¡¹ç›®éƒ½æ˜¯å¯ä»¥å…è´¹ä½¿ç”¨çš„ã€‚å¦‚æœä½ ä¹Ÿæƒ³å°½å¿«ä½¿ç”¨çš„è¯ï¼Œå¯ä»¥é€šè¿‡é“¾æ¥ https://github.com/features/actions/signup å»ç”³è¯·æƒé™ã€‚
">
  <meta property="og:description" content="GitHub å‰ä¸€æ®µæ—¶é—´æ¨å‡ºäº†è‡ªå®¶çš„è‡ªåŠ¨åŒ–æ„å»ºå·¥å…·ï¼šGitHub Actionsï¼Œä¸è¿‡ç›®å‰è¿˜æ²¡æœ‰å¼€æ”¾æ³¨å†Œï¼Œåªèƒ½é€šè¿‡ç”³è¯·ç­‰å¾…å®˜æ–¹å®¡æ ¸ã€‚æˆ‘ç¬¬ä¸€æ—¶é—´å°±æäº¤äº†ç”³è¯·ï¼Œç°åœ¨å·²ç»å®¡æ ¸é€šè¿‡äº†ï¼Œæ‰€ä»¥ç¬¬ä¸€æ—¶é—´ä½“éªŒäº†GitHub Actionsçš„åŠŸèƒ½ï¼Œæ€»ä½“æ„Ÿå—æ˜¯ Travis CI ä¹‹ç±»çš„å·¥å…·åº”è¯¥ç°åœ¨åœ¨å¢™è§’ç‘Ÿç‘Ÿå‘æŠ–å§ ğŸ˜„ï¼Ÿ
GitHub Actionså…è®¸æ„å»ºä¸€ä¸ªå®Œæ•´çš„ CI/CD Pipelineï¼Œä¸ GitHub ç”Ÿæ€ç³»ç»Ÿæ·±åº¦é›†æˆï¼Œè€Œæ— éœ€ä½¿ç”¨ Travis CI æˆ–è€… Circle CI ç­‰ç¬¬ä¸‰æ–¹æœåŠ¡ï¼Œå¯¹äºå¼€æºé¡¹ç›®éƒ½æ˜¯å¯ä»¥å…è´¹ä½¿ç”¨çš„ã€‚å¦‚æœä½ ä¹Ÿæƒ³å°½å¿«ä½¿ç”¨çš„è¯ï¼Œå¯ä»¥é€šè¿‡é“¾æ¥ https://github.com/features/actions/signup å»ç”³è¯·æƒé™ã€‚
">
  <meta name="twitter:description" content="GitHub å‰ä¸€æ®µæ—¶é—´æ¨å‡ºäº†è‡ªå®¶çš„è‡ªåŠ¨åŒ–æ„å»ºå·¥å…·ï¼šGitHub Actionsï¼Œä¸è¿‡ç›®å‰è¿˜æ²¡æœ‰å¼€æ”¾æ³¨å†Œï¼Œåªèƒ½é€šè¿‡ç”³è¯·ç­‰å¾…å®˜æ–¹å®¡æ ¸ã€‚æˆ‘ç¬¬ä¸€æ—¶é—´å°±æäº¤äº†ç”³è¯·ï¼Œç°åœ¨å·²ç»å®¡æ ¸é€šè¿‡äº†ï¼Œæ‰€ä»¥ç¬¬ä¸€æ—¶é—´ä½“éªŒäº†GitHub Actionsçš„åŠŸèƒ½ï¼Œæ€»ä½“æ„Ÿå—æ˜¯ Travis CI ä¹‹ç±»çš„å·¥å…·åº”è¯¥ç°åœ¨åœ¨å¢™è§’ç‘Ÿç‘Ÿå‘æŠ–å§ ğŸ˜„ï¼Ÿ
GitHub Actionså…è®¸æ„å»ºä¸€ä¸ªå®Œæ•´çš„ CI/CD Pipelineï¼Œä¸ GitHub  â€¦">
  <meta name="author" content=""/>
  <link href="https://picdn.youdianzhishi.com/images/blog-favicon.png" rel="icon" type="image/x-icon" />
  <link rel="apple-touch-icon" href="https://picdn.youdianzhishi.com/images/blog-favicon.png"/>
  <meta property="og:image" content="https://picdn.youdianzhishi.com/images/blog-favicon.png" />
  <meta name="twitter:image" content="https://picdn.youdianzhishi.com/images/blog-favicon.png" />
  <meta name="twitter:card" content="summary" />
  <meta property="og:url" content="https://www.qikqiak.com/post/use-github-actions-build-go-app/" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="é˜³æ˜çš„åšå®¢" />

  <link rel="canonical" href="https://www.qikqiak.com/post/use-github-actions-build-go-app/" />
  <link rel="alternate" href="https://www.qikqiak.com/index.xml" type="application/rss+xml" title="é˜³æ˜çš„åšå®¢">

  
  
  <link href="https://fonts.googleapis.com/css?family=Lora:400,400i,700%7COpen+Sans:400,700" rel="stylesheet">
  

  <link rel="stylesheet" href='https://www.qikqiak.com/css/bundle.min.a6b62363fe57848ad01efa2a5d1bbb1047c2ffb71b53d8aeb42bc5ed5c77ea7c.css' integrity='sha256-prYjY/5XhIrQHvoqXRu7EEfC/7cbU9iutCvF7Vx36nw='>

  <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.css"/>
  
  
    
    <!--[if lt IE 9]>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js"></script>
        <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <![endif]-->
<meta name="google-site-verification" content="oKxX4fOvB2yYmU02txZFChM93XQbESU4JaG3tNH9Hm8" />
<meta name="baidu-site-verification" content="F5ojAyqaKU" />
<meta name="keywords" content="CI, CD, github, GitHub Actions, golang, pipeline">
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?d611849735f187dd788dc054908f7d7a";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>



<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-69668147-3', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</head>

  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">åˆ‡æ¢å¯¼èˆª</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://www.qikqiak.com/" title="é˜³æ˜çš„åšå®¢">
        <img src="https://picdn.youdianzhishi.com/images/blog-logo-new.png" style="margin-top: -5px;height: 32px;" alt="é˜³æ˜çš„åšå®¢">
      </a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li>
              <a title="é¦–é¡µ" href="https://www.qikqiak.com/">é¦–é¡µ</a>
            </li>
          
        
          
            <li>
              <a title="è¯¾ç¨‹" href="https://youdianzhishi.com/?utm_source=blog&amp;utm_campaign=referral&amp;utm_medium=topmenu">è¯¾ç¨‹</a>
            </li>
          
        
          
            <li class="navlinks-container">
              <a class="navlinks-parent" href="javascript:void(0)">æ–‡ç« åˆ†ç±»</a>
              <div class="navlinks-children">
                
                  <a href="https://www.qikqiak.com/archives">Archive</a>
                
                  <a href="https://www.qikqiak.com/tags">tags</a>
                
                  <a href="https://www.qikqiak.com/tags/kubernetes">kubernetes</a>
                
                  <a href="https://www.qikqiak.com/tags/python">python</a>
                
                  <a href="https://www.qikqiak.com/tags/django">django</a>
                
                  <a href="https://www.qikqiak.com/tags/devops">devops</a>
                
              </div>
            </li>
          
        
          
            <li class="navlinks-container">
              <a class="navlinks-parent" href="javascript:void(0)">ä¹¦ç±</a>
              <div class="navlinks-children">
                
                  <a href="https://www.qikqiak.com/k8s-book/">k8sè¿›é˜¶æ‰‹å†Œ</a>
                
                  <a href="https://www.qikqiak.com/istio-book/">ä¸€èµ·å­¦istio</a>
                
                  <a href="https://www.qikqiak.com/tdd-book/">Pythonå¾®æœåŠ¡</a>
                
                  <a href="https://md.qikqiak.com/">Markdownå¾®ä¿¡</a>
                
              </div>
            </li>
          
        
          
            <li>
              <a title="å…³äº" href="https://www.qikqiak.com/page/about/">å…³äº</a>
            </li>
          
        
          
            <li>
              <a title="RSS" href="https://www.qikqiak.com/index.xml">RSS</a>
            </li>
          
        

        

        

        
          <li>
            <a href="#modalSearch" data-toggle="modal" data-target="#modalSearch" style="outline: none;">
              <span id="searchGlyph" class="glyphicon glyphicon-search"></span>
            </a>
          </li>
          

      </ul>
    </div>

  </div>
</nav>


  <div id="modalSearch" class="modal fade" role="dialog">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">æœç´¢</h4>
        </div>
        <div class="modal-body">
            
<div class="aa-input-container" id="aa-input-container">
    <input type="search" id="aa-search-input" class="aa-input-search" placeholder="Search for titles or URIs..." name="search" autocomplete="off" />
    <svg class="aa-input-icon" viewBox="654 -372 1664 1664">
        <path d="M1806,332c0-123.3-43.8-228.8-131.5-316.5C1586.8-72.2,1481.3-116,1358-116s-228.8,43.8-316.5,131.5  C953.8,103.2,910,208.7,910,332s43.8,228.8,131.5,316.5C1129.2,736.2,1234.7,780,1358,780s228.8-43.8,316.5-131.5  C1762.2,560.8,1806,455.3,1806,332z M2318,1164c0,34.7-12.7,64.7-38,90s-55.3,38-90,38c-36,0-66-12.7-90-38l-343-342  c-119.3,82.7-252.3,124-399,124c-95.3,0-186.5-18.5-273.5-55.5s-162-87-225-150s-113-138-150-225S654,427.3,654,332  s18.5-186.5,55.5-273.5s87-162,150-225s138-113,225-150S1262.7-372,1358-372s186.5,18.5,273.5,55.5s162,87,225,150s113,138,150,225  S2062,236.7,2062,332c0,146.7-41.3,279.7-124,399l343,343C2305.7,1098.7,2318,1128.7,2318,1164z" />
    </svg>
</div>
<script src="https://www.qikqiak.com/js/algoliasearch.min.js"></script>
<script src="https://www.qikqiak.com/js/autocomplete.min.js"></script>

<script>
var client = algoliasearch("1JDRAS0AZR", "8804ac109158bb3bb60d74ce98fa332f");
var index = client.initIndex('prod_blog');

autocomplete('#aa-search-input',
{ hint: false}, {
    source: autocomplete.sources.hits(index, {hitsPerPage: 5}),
    
    displayKey: 'name',
    
    templates: {
        
        suggestion: function(suggestion) {
            return '<span>' + '<a href="https://www.qikqiak.com/post/' + suggestion.slug + '">' +
            suggestion._highlightResult.title.value + '</a></span>';
        }
    }
});
</script>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">close</button>
        </div>
      </div>
    </div>
  </div>

    
  
  
  




  
    <div id="header-big-imgs" data-num-img=1 data-img-src-1="https://picdn.youdianzhishi.com/images/photo-1566568216493-71bf7995310a.jpeg" data-img-desc-1="https://unsplash.com/photos/MUbcybuo7aY"></div>
  

  <header class="header-section has-img">
    
      <div class="intro-header big-img">
        
        <div class="container">
          <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
              <div class="post-heading">
                <h1>ä½¿ç”¨ GitHub Actions è‡ªåŠ¨åŒ–æ„å»º Golang åº”ç”¨</h1>
                  
                  
                    <span class="post-meta">
  å‘è¡¨äº August 24, 2019  
</span>

                  
              </div>
            </div>
          </div>
        </div>
        <span class="img-desc" style="display: inline;"></span>
      </div>
    
    
    
    <div class="intro-header no-img">
      
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="post-heading">
              <h1>ä½¿ç”¨ GitHub Actions è‡ªåŠ¨åŒ–æ„å»º Golang åº”ç”¨</h1>
                
                
                  <span class="post-meta">
  å‘è¡¨äº August 24, 2019  
</span>

                
            </div>
          </div>
        </div>
      </div>
    </div>
    
    
  </header>


    



<div class="container" role="main">
  <div class="row">

    
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div>
            
            
            <h5 id="tags" style="margin-top: 30px;">æ ‡ç­¾:
              
                  <a href="https://www.qikqiak.com/tags/ci/">CI</a> &nbsp;
              
                  <a href="https://www.qikqiak.com/tags/cd/">CD</a> &nbsp;
              
                  <a href="https://www.qikqiak.com/tags/github/">github</a> &nbsp;
              
                  <a href="https://www.qikqiak.com/tags/golang/">golang</a> &nbsp;
              
                  <a href="https://www.qikqiak.com/tags/pipeline/">pipeline</a> &nbsp;
              
            </h5>
            
        </div>
  
        <article role="main" class="blog-post" itemprop="articleBody" id="content">
          
            
<aside class="toc">
  <nav id="TableOfContents">
  <ul>
    <li><a href="#golang-é¡¹ç›®">Golang é¡¹ç›®</a></li>
    <li><a href="#github-actions-pipeline">GitHub Actions Pipeline</a>
      <ul>
        <li><a href="#main-workflow">main workflow</a></li>
        <li><a href="#release-workflow">release workflow</a></li>
      </ul>
    </li>
    <li><a href="#æ€»ç»“">æ€»ç»“</a></li>
    <li><a href="#å‚è€ƒæ–‡æ¡£">å‚è€ƒæ–‡æ¡£</a></li>
  </ul>
</nav>
</aside>

          
  
          
          
          
  
          
          
          
  
          
          
          

          <p>GitHub å‰ä¸€æ®µæ—¶é—´æ¨å‡ºäº†è‡ªå®¶çš„è‡ªåŠ¨åŒ–æ„å»ºå·¥å…·ï¼š<a href="https://github.com/features/actions">GitHub Actions</a>ï¼Œä¸è¿‡ç›®å‰è¿˜æ²¡æœ‰å¼€æ”¾æ³¨å†Œï¼Œåªèƒ½é€šè¿‡ç”³è¯·ç­‰å¾…å®˜æ–¹å®¡æ ¸ã€‚æˆ‘ç¬¬ä¸€æ—¶é—´å°±æäº¤äº†ç”³è¯·ï¼Œç°åœ¨å·²ç»å®¡æ ¸é€šè¿‡äº†ï¼Œæ‰€ä»¥ç¬¬ä¸€æ—¶é—´ä½“éªŒäº†<code>GitHub Actions</code>çš„åŠŸèƒ½ï¼Œæ€»ä½“æ„Ÿå—æ˜¯ Travis CI ä¹‹ç±»çš„å·¥å…·åº”è¯¥ç°åœ¨åœ¨å¢™è§’<code>ç‘Ÿç‘Ÿå‘æŠ–</code>å§ ğŸ˜„ï¼Ÿ</p>
<p><code>GitHub Actions</code>å…è®¸æ„å»ºä¸€ä¸ªå®Œæ•´çš„ CI/CD Pipelineï¼Œä¸ GitHub ç”Ÿæ€ç³»ç»Ÿæ·±åº¦é›†æˆï¼Œè€Œæ— éœ€ä½¿ç”¨ Travis CI æˆ–è€… Circle CI ç­‰ç¬¬ä¸‰æ–¹æœåŠ¡ï¼Œå¯¹äºå¼€æºé¡¹ç›®éƒ½æ˜¯å¯ä»¥å…è´¹ä½¿ç”¨çš„ã€‚å¦‚æœä½ ä¹Ÿæƒ³å°½å¿«ä½¿ç”¨çš„è¯ï¼Œå¯ä»¥é€šè¿‡é“¾æ¥ <a href="https://github.com/features/actions/signup">https://github.com/features/actions/signup</a> å»ç”³è¯·æƒé™ã€‚</p>
<p><img src="https://picdn.youdianzhishi.com/images/github-actions.jpg" alt="github actions"></p>
<h2 id="golang-é¡¹ç›®">Golang é¡¹ç›®</h2>
<p>ä¸ºäº†æ¼”ç¤º<code>GitHub Actions</code>çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬è¿™é‡Œæ¥æ„å»ºä¸€ä¸ªæœ€ç®€å•çš„&quot;Hello world&quot;çš„ Golang ç¨‹åºï¼Œå…¶ä¸­å°±åŒ…å«ä¸€ä¸ªåŸºæœ¬çš„ Pipelineï¼Œæ¯æ¬¡<code>Pull Request</code>æˆ–è€…æ¨é€ä»£ç åˆ° master åˆ†æ”¯çš„æ—¶å€™å°±ä¼šè§¦å‘è¯¥ Pipeline çš„è‡ªåŠ¨æ„å»ºï¼Œè¿›è¡Œä»£ç çš„ lint æ“ä½œã€è¿è¡Œå•å…ƒæµ‹è¯•å¹¶ä½¿ç”¨ <a href="https://codecov.io/">Codecov</a> ç”Ÿæˆä»£ç è¦†ç›–ç‡æŠ¥å‘Šã€‚</p>
<p>å½“åœ¨ä»“åº“ä¸Šåˆ›å»ºä¸€ä¸ªæ–°çš„<code>tag</code>çš„æ—¶å€™ï¼ŒPipeline ä¼šä½¿ç”¨ <a href="https://goreleaser.com/">GoReleaser</a> å·¥å…·å‘å¸ƒä¸€ä¸ªæ–°çš„ GitHub ç‰ˆæœ¬ã€‚</p>
<blockquote>
<p>GoReleaser æ˜¯ä¸€ä¸ª Golang é¡¹ç›®çš„è‡ªåŠ¨åŒ–å‘å¸ƒå·¥å…·ï¼Œå¯ä»¥ç®€åŒ–æ„å»ºã€å‘å¸ƒæµç¨‹ï¼Œä¸ºæ‰€æœ‰æµç¨‹æä¾›äº†ä¸€äº›è‡ªå®šä¹‰çš„é€‰é¡¹ã€‚</p>
</blockquote>
<p>åœ¨ GitHub ä¸Šæ–°å»ºä¸€ä¸ªåä¸º <a href="https://github.com/cnych/go-github-actions">go-github-actions</a>çš„ä»“åº“ï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹é¢åˆ›å»ºä¸€ä¸ª main.go æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-golang" data-lang="golang"><span style="display:flex;"><span><span style="color:#ff79c6">package</span> main
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#f1fa8c">&#34;fmt&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#f1fa8c">&#34;github.com/cnych/go-github-actions/hello&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">main</span>() {
</span></span><span style="display:flex;"><span>	fmt.<span style="color:#50fa7b">Println</span>(hello.<span style="color:#50fa7b">Greet</span>())
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬è°ƒç”¨äº† hello è¿™ä¸ª package ä¸‹é¢çš„ Greet å‡½æ•°ï¼Œæ‰€ä»¥éœ€è¦åœ¨æ ¹ç›®å½•ä¸‹é¢æ–°å»ºä¸€ä¸ªåä¸º hello çš„ packageï¼Œåœ¨ package ä¸‹é¢æ–°å»ºä¸€ä¸ª hellog.go çš„æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-golang" data-lang="golang"><span style="display:flex;"><span><span style="color:#ff79c6">package</span> hello
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">// Greet... Greet GitHub Actions
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span><span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">Greet</span>() <span style="color:#8be9fd">string</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">return</span> <span style="color:#f1fa8c">&#34;Hello GitHub Actions&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹é¢åˆå§‹åŒ– go modulesï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ go mod init github.com/cnych/go-github-actions
</span></span><span style="display:flex;"><span>go: creating new go.mod: module github.com/cnych/go-github-actions
</span></span></code></pre></div><p>ç„¶ååœ¨ hello è¿™ä¸ª package ä¸‹é¢åˆ›å»ºä¸€ä¸ªå•å…ƒæµ‹è¯•çš„æ–‡ä»¶ï¼ˆhello_test.goï¼‰ï¼Œå†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-golang" data-lang="golang"><span style="display:flex;"><span><span style="color:#ff79c6">package</span> hello
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> <span style="color:#f1fa8c">&#34;testing&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">TestGreet</span>(t <span style="color:#ff79c6">*</span>testing.T) {
</span></span><span style="display:flex;"><span>	result <span style="color:#ff79c6">:=</span> <span style="color:#50fa7b">Greet</span>()
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">if</span> result <span style="color:#ff79c6">!=</span> <span style="color:#f1fa8c">&#34;Hello GitHub Actions&#34;</span> {
</span></span><span style="display:flex;"><span>		t.<span style="color:#50fa7b">Errorf</span>(<span style="color:#f1fa8c">&#34;Greet() = %s; Expected Hello GitHub actions&#34;</span>, result)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>åœ¨æ ¹ç›®å½•ä¸‹é¢æ‰§è¡Œå•å…ƒæµ‹è¯•ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-golang" data-lang="golang"><span style="display:flex;"><span>$ <span style="color:#ff79c6">go</span> test .<span style="color:#ff79c6">/</span>hello
</span></span><span style="display:flex;"><span>ok  	github.com<span style="color:#ff79c6">/</span>cnych<span style="color:#ff79c6">/</span><span style="color:#ff79c6">go</span><span style="color:#ff79c6">-</span>github<span style="color:#ff79c6">-</span>actions<span style="color:#ff79c6">/</span>hello	<span style="color:#bd93f9">0.007</span>s
</span></span><span style="display:flex;"><span>$ <span style="color:#ff79c6">go</span> run main.<span style="color:#ff79c6">go</span>
</span></span><span style="display:flex;"><span>Hello GitHub Actions
</span></span></code></pre></div><p>æœ€ç»ˆçš„ä»£ç ç»“æ„å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ tree .
</span></span><span style="display:flex;"><span>.
</span></span><span style="display:flex;"><span>â”œâ”€â”€ README.md
</span></span><span style="display:flex;"><span>â”œâ”€â”€ go.mod
</span></span><span style="display:flex;"><span>â”œâ”€â”€ hello
</span></span><span style="display:flex;"><span>â”‚Â Â  â”œâ”€â”€ hello.go
</span></span><span style="display:flex;"><span>â”‚Â Â  â””â”€â”€ hello_test.go
</span></span><span style="display:flex;"><span>â””â”€â”€ main.go
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1</span> directory, <span style="color:#bd93f9">5</span> files
</span></span></code></pre></div><p>æœ€åä¸è¦å¿˜è®°æŠŠä»£ç æ¨é€åˆ° GitHub ä¸Šé¢å»ã€‚</p>
<!-- raw HTML omitted -->
<h2 id="github-actions-pipeline">GitHub Actions Pipeline</h2>
<p>å½“æˆ‘ä»¬æŠŠä»£ç æ¨é€åˆ° GitHub ä¸Šå»è¿‡åï¼Œåœ¨é¡µé¢ä¸Šå¯ä»¥çœ‹åˆ° Actions çš„å…¥å£ï¼ˆå‰ææ˜¯å·²ç»å¼€é€šäº†ï¼‰ï¼š</p>
<p><img src="https://picdn.youdianzhishi.com/images/github-actions-config.jpg" alt="github actions config"></p>
<p>åœ¨é¡µé¢ä¸­å¯ä»¥çœ‹åˆ° Actions ä¸ºæˆ‘ä»¬æä¾›äº†å¾ˆå¤šå†…ç½®çš„ workflowï¼Œæ¯”å¦‚ golangã€Rustã€Pythonã€Node ç­‰ç­‰ï¼Œæˆ‘ä»¬è¿™é‡Œæ¥è‡ªå·±ç¼–å†™ workflowï¼Œç‚¹å‡»å³ä¸Šè§’çš„<code>Set up a workflow yourself</code>ï¼Œè·³è½¬åˆ° Pipeline çš„ç¼–å†™é¡µé¢ï¼š</p>
<p><img src="https://picdn.youdianzhishi.com/images/github-actions-custom.png" alt="github actions pipeline custom"></p>
<p>å¯ä»¥é€šè¿‡å±æ€§<code>on</code>æ¥æ§åˆ¶ workflow è¢«è§¦å‘æ„å»ºçš„æ¡ä»¶ï¼Œæ¯”å¦‚å½“ä»£ç æ¨é€åˆ°<code>master</code>å’Œ<code>release</code>åˆ†æ”¯çš„æ—¶å€™è§¦å‘æ„å»ºï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#ff79c6">on</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">push</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">branches</span>:
</span></span><span style="display:flex;"><span>      - master
</span></span><span style="display:flex;"><span>      - release/*
</span></span></code></pre></div><p>å½“åªæœ‰<code>pull_request</code>è¢«åˆå¹¶åˆ°<code>master</code>åˆ†æ”¯çš„æ—¶å€™ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#ff79c6">on</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">pull_request</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">branches</span>:
</span></span><span style="display:flex;"><span>      - master
</span></span></code></pre></div><p>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡å®šæ—¶ä»»åŠ¡æ¥è¿›è¡Œè§¦å‘ï¼Œæ¯”å¦‚æ˜ŸæœŸä¸€åˆ°æ˜ŸæœŸäº”çš„æ¯å¤© 2 ç‚¹æ„å»ºä»»åŠ¡å‘¢ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#ff79c6">on</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">schedule</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#ff79c6">cron</span>: <span style="color:#bd93f9">0</span> <span style="color:#bd93f9">2</span> * * <span style="color:#bd93f9">1-5</span>
</span></span></code></pre></div><p>GitHub Actions Workflow çš„å®Œæ•´è¯­æ³•å¯ä»¥åœ¨æ–‡æ¡£ <a href="https://help.github.com/articles/workflow-syntax-for-github-actions">https://help.github.com/articles/workflow-syntax-for-github-actions</a> ä¸­æŸ¥çœ‹åˆ°ã€‚</p>
<p>å¦å¤–ä¸€ä¸ªæ¯”è¾ƒé‡è¦çš„æ˜¯<code>action</code>ï¼Œactions æ˜¯å¯é‡å¤ä½¿ç”¨çš„å·¥ä½œå•å…ƒï¼Œå¯ç”±ä»»ä½•äººåœ¨ GitHub ä¸Šæ„å»ºå’Œåˆ†å‘ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ GitHub marketplace ä¸­æ‰¾æ‰“å„ç§å„æ ·çš„æ“ä½œï¼Œé€šè¿‡æŒ‡å®šåŒ…å« action å’Œ æƒ³ä½¿ç”¨çš„ ref æ¥è¿›è¡Œæ“ä½œï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>- <span style="color:#ff79c6">name</span>: &lt; display name for action &gt;
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">uses</span>: {owner}/{repo}@ref
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">with</span>:
</span></span><span style="display:flex;"><span>      &lt;map of inputs&gt;
</span></span></code></pre></div><p>é€šè¿‡æŸ¥çœ‹ GitHub Actions ä¸ºæˆ‘ä»¬ç”Ÿæˆçš„é»˜è®¤çš„ workflow è„šæœ¬ï¼Œæˆ‘ä»¬å°±å¯ä»¥çœ‹å‡º workflow æ˜¯æ»¡è¶³æŸäº›æ¡ä»¶æˆ–äº‹ä»¶çš„æ—¶å€™çš„ä¸€ç»„ä»»åŠ¡ï¼ˆjobï¼‰å’Œæ­¥éª¤ï¼ˆstepï¼‰ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#ff79c6">name</span>: CI
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">on</span>: [push]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">jobs</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">build</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">runs-on</span>: ubuntu-latest
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">steps</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ff79c6">uses</span>: actions/checkout@v1
</span></span><span style="display:flex;"><span>      - <span style="color:#ff79c6">name</span>: Run a one-line script
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">run</span>: echo Hello, world!
</span></span><span style="display:flex;"><span>      - <span style="color:#ff79c6">name</span>: Run a multi-line script
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">run</span>: |<span style="color:#f1fa8c">
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">          echo Add other actions to build,
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">          echo test, and deploy your project.</span>          
</span></span></code></pre></div><p>åœ¨ä¸€ä¸ªé¡¹ç›®ä¸­è¿˜å¯ä»¥æœ‰å¤šä¸ª workflowï¼Œæ¯ä¸ª workflow éƒ½å“åº”ä¸€ç»„ä¸åŒçš„äº‹ä»¶ã€‚</p>
<h3 id="main-workflow">main workflow</h3>
<p>åœ¨æˆ‘ä»¬è¿™é‡Œçš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†ä¼šå®šä¹‰ä¸¤ä¸ª workflowï¼Œæ¨é€ä»£ç åˆ° master åˆ†æ”¯æˆ–è€…åˆ›å»º PR çš„æ—¶å€™å°†è§¦å‘ Build çš„ workflowï¼Œå½“åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ tag çš„æ—¶å€™ï¼Œä¼šè§¦å‘ Release çš„ workflowï¼Œè¯¥å·¥ä½œæµä¼šå‘å¸ƒä¸€ä¸ªæ–°çš„åº”ç”¨ç‰ˆæœ¬ã€‚</p>
<p>æ¯ä¸ª workflow ç”±ä¸€ä¸ªæˆ–å¤šä¸ª Job ç»„æˆï¼Œæˆ‘ä»¬çš„ Build Workflow åŒ…å« 3 ä¸ª Jobï¼ˆLintã€Build å’Œ Testï¼‰ï¼Œè€Œ Release Workflow åªåŒ…å«ä¸€ä¸ª Release çš„ Jobã€‚</p>
<p>æ¯ä¸ª Job éƒ½ç”±å¤šä¸ª Step ç»„æˆï¼Œæ¯”å¦‚ï¼Œâ€œå•å…ƒæµ‹è¯•â€çš„ Job å°±åŒ…å«è·å–ä»£ç ã€è¿è¡Œæµ‹è¯•å’Œç”Ÿäº§ä»£ç è¦†ç›–ç‡æŠ¥å‘Šçš„å‡ ä¸ªæ­¥éª¤ã€‚</p>
<p>Workflow ä¼šè¢«å®šä¹‰åœ¨ä»£ç ä»“åº“æ ¹ç›®å½•ä¸‹é¢çš„<code>.github/workflows</code>ç›®å½•ä¸­çš„ YAML æ–‡ä»¶ä¸­ï¼Œè¯¥ç›®å½•ä¸‹é¢çš„æ¯ä¸ªæ–‡ä»¶å°±ä»£è¡¨äº†ä¸åŒçš„å·¥ä½œæµã€‚</p>
<p>ä¸‹é¢æ˜¯æˆ‘ä»¬å®šä¹‰çš„ Build Workflowï¼šï¼ˆmain.yamlï¼‰</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#ff79c6">name</span>: Build and Test
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">on</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">push</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">branches</span>:
</span></span><span style="display:flex;"><span>      - master
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">pull_request</span>:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">jobs</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">lint</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">name</span>: Lint
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">runs-on</span>: ubuntu-latest
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">steps</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ff79c6">name</span>: Set up Go
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">uses</span>: actions/setup-go@v1
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">with</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">go-version</span>: <span style="color:#bd93f9">1.12</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ff79c6">name</span>: Check out code
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">uses</span>: actions/checkout@v1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ff79c6">name</span>: Lint Go Code
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">run</span>: |<span style="color:#f1fa8c">
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">          export PATH=$PATH:$(go env GOPATH)/bin # temporary fix. See https://github.com/actions/setup-go/issues/14
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">          go get -u golang.org/x/lint/golint 
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">          make lint</span>          
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">test</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">name</span>: Test
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">runs-on</span>: ubuntu-latest
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">steps</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ff79c6">name</span>: Set up Go
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">uses</span>: actions/setup-go@v1
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">with</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">go-version</span>: <span style="color:#bd93f9">1.12</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ff79c6">name</span>: Check out code
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">uses</span>: actions/checkout@v1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ff79c6">name</span>: Run Unit tests.
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">run</span>: make test-coverage
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ff79c6">name</span>: Upload Coverage report to CodeCov
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">uses</span>: codecov/codecov-action@v1.0.0
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">with</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">token</span>: ${{secrets.CODECOV_TOKEN}}
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">file</span>: ./coverage.txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">build</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">name</span>: Build
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">runs-on</span>: ubuntu-latest
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">needs</span>: [lint, test]
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">steps</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ff79c6">name</span>: Set up Go
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">uses</span>: actions/setup-go@v1
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">with</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">go-version</span>: <span style="color:#bd93f9">1.12</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ff79c6">name</span>: Check out code
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">uses</span>: actions/checkout@v1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ff79c6">name</span>: Build
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">run</span>: make build
</span></span></code></pre></div><p>æˆ‘ä»¬é¦–å…ˆå®šä¹‰äº† workflow çš„åç§°å’Œè§¦å‘è§„åˆ™ï¼Œæˆ‘ä»¬å¸Œæœ›ä»£ç æ¨é€åˆ° master åˆ†æ”¯æˆ–è€…æ‰§è¡Œä¸€ä¸ª PR çš„æ—¶å€™è§¦å‘ï¼Œæ‰€ä»¥å®šä¹‰çš„è§¦å‘å™¨è§„åˆ™å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#ff79c6">on</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">push</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">branches</span>:
</span></span><span style="display:flex;"><span>      - master
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">pull_request</span>:
</span></span></code></pre></div><p>ç„¶ååœ¨æ•´ä¸ª workflow ä¸­åŒ…å«äº† 3 ä¸ª Jobï¼šLintã€Test å’Œ Buildï¼ŒLint çš„ Job å®šä¹‰å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#ff79c6">lint</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">name</span>: Lint
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">runs-on</span>: ubuntu-latest
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">steps</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#ff79c6">name</span>: Set up Go
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">uses</span>: actions/setup-go@v1
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">with</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">go-version</span>: <span style="color:#bd93f9">1.12</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    - <span style="color:#ff79c6">name</span>: Check out code
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">uses</span>: actions/checkout@v1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    - <span style="color:#ff79c6">name</span>: Lint Go Code
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">run</span>: |<span style="color:#f1fa8c">
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">        export PATH=$PATH:$(go env GOPATH)/bin # temporary fix. See https://github.com/actions/setup-go/issues/14
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">        go get -u golang.org/x/lint/golint 
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">        make lint</span>        
</span></span></code></pre></div><p>è¿™é‡Œæˆ‘ä»¬æŒ‡å®šäº†æˆ‘ä»¬å¸Œæœ›è¿™ä¸ª Job ä»»åŠ¡åœ¨ ubuntu æœºå™¨ä¸Šè¿è¡Œï¼ˆ<code>runs-on</code>å…³é”®å­—ï¼‰ã€‚Actions ç°åœ¨æ”¯æŒ Linuxã€Macã€Windows å’Œ Docker ç¯å¢ƒï¼Œåœ¨ä»¥åï¼Œä¹Ÿå¯ä»¥å°†è‡ªå·±çš„æœºå™¨æ¥ä½œä¸º runners è¿è¡Œï¼Œç±»ä¼¼ä¸ GitLab CI Runnerã€‚ç„¶åå®šä¹‰äº†è¯¥ Job ä»»åŠ¡çš„æ‰§è¡Œæ­¥éª¤ï¼š</p>
<p>é¦–å…ˆæ˜¯å®‰è£… Golang ç¯å¢ƒï¼ŒGitHub å·²ç»æä¾›äº†è¿™æ ·çš„ä¸€ä¸ª actionï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥ä½¿ç”¨å³å¯ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>- <span style="color:#ff79c6">name</span>: Set up Go
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">uses</span>: actions/setup-go@v1
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">with</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">go-version</span>: <span style="color:#bd93f9">1.12</span>
</span></span></code></pre></div><blockquote>
<p>å¯ä»¥åœ¨ GitHub marketplace ä¸Šé¢æ‰¾åˆ° action çš„å…·ä½“ä½¿ç”¨æ–¹æ³•ï¼š<a href="https://github.com/marketplace/actions/setup-go-for-use-with-actions">https://github.com/marketplace/actions/setup-go-for-use-with-actions</a>ã€‚</p>
</blockquote>
<p>å…¶å®è¿™é‡Œçš„æ­¥éª¤å£°æ˜è¯­æ³•å¾ˆæ˜ç¡®äº†ï¼Œ<code>with</code>å…³é”®å­—å…è®¸æˆ‘ä»¬æŒ‡å®š action æ‰€éœ€çš„å‚æ•°ï¼Œè¿™é‡Œ<code>setup-go</code>è¿™ä¸ª action å…è®¸æˆ‘ä»¬æŒ‡å®šè¦ä½¿ç”¨çš„ go ç‰ˆæœ¬ï¼Œç”±äºæˆ‘ä»¬ä¸Šé¢çš„ä¾‹å­ä¸­ä½¿ç”¨äº† go modulesï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡ŒæŒ‡å®šä½¿ç”¨çš„æ˜¯<code>1.12</code>ç‰ˆæœ¬ï¼ˆå¤§äº 1.11 å³å¯ï¼‰ï¼Œç„¶åä¸‹ä¸€ä¸ªæ­¥éª¤å°±æ˜¯è·å–æºä»£ç ï¼ŒåŒæ ·è¿™é‡Œè¿˜æ˜¯ç›´æ¥ä½¿ç”¨å†…ç½®çš„ä¸€ä¸ª actionï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>- <span style="color:#ff79c6">name</span>: Check out code
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">uses</span>: actions/checkout@v1
</span></span></code></pre></div><p>ç„¶åæˆ‘ä»¬å®‰è£…å’Œè¿è¡Œ<code>golint</code>å·¥å…·ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>- <span style="color:#ff79c6">name</span>: Lint Go Code
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">run</span>: |<span style="color:#f1fa8c">
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">    export PATH=$PATH:$(go env GOPATH)/bin
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">    go get -u golang.org/x/lint/golint 
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">    make lint</span>    
</span></span></code></pre></div><p>è¿™æ · Lint è¿™ä¸ª Job ä»»åŠ¡å°±å®šä¹‰å®Œæˆäº†ï¼Œå…¶ä½™çš„ Job ä¹Ÿéå¸¸ç±»ä¼¼ï¼Œæ¯”å¦‚æˆ‘ä»¬å†æ¥çœ‹ä¸‹ Test è¿™ä¸ª Job ä»»åŠ¡ï¼Œå®šä¹‰å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#ff79c6">test</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">name</span>: Test
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">runs-on</span>: ubuntu-latest
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">steps</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#ff79c6">name</span>: Set up Go
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">uses</span>: actions/setup-go@v1
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">with</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">go-version</span>: <span style="color:#bd93f9">1.12</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    - <span style="color:#ff79c6">name</span>: Check out code
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">uses</span>: actions/checkout@v1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    - <span style="color:#ff79c6">name</span>: Run Unit tests.
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">run</span>: make test-coverage
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    - <span style="color:#ff79c6">name</span>: Upload Coverage report to CodeCov
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">uses</span>: codecov/codecov-action@v1.0.0
</span></span><span style="display:flex;"><span>      <span style="color:#ff79c6">with</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">token</span>: ${{secrets.CODECOV_TOKEN}}
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">file</span>: ./coverage.txt
</span></span></code></pre></div><p>è¿™é‡Œçš„å®šä¹‰å”¯ä¸€ä¸åŒçš„æ˜¯ä¸Šä¼ ä»£ç æµ‹è¯•è¦†ç›–ç‡ä½¿ç”¨çš„ action æ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹çš„ï¼Œå½“ç„¶è¿™ä¸ª action ä¹Ÿåœ¨ marketplace ä¸Šé¢å¯ä»¥æ‰¾åˆ°ï¼š<a href="https://github.com/marketplace/actions/codecov">https://github.com/marketplace/actions/codecov</a>ï¼Œæˆ‘ä»¬ä¼šå°†æµ‹è¯•çš„ä»£ç è¦†ç›–ç‡ä¸Šä¼ åˆ° <a href="https://www.codecov.io/">CodeCov</a>ã€‚è¿™é‡Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ GitHub çš„<code>secrets</code>æ¥å­˜å‚¨æ“ä½œ CodeCov æ‰€éœ€è¦çš„<code>Codecov Token</code>ï¼Œåœ¨ CodeCov ç½‘ç«™ä¸Šé€šè¿‡ GitHub ç”¨æˆ·æˆæƒç™»å½•ï¼Œç„¶åå¯ç”¨ä¸Šé¢çš„[go-github-actions]é¡¹ç›®ï¼Œå°±å¯ä»¥è·å¾—<code>Codecov Token</code>çš„å€¼ï¼Œç„¶ååœ¨ GitHub é¡¹ç›® settings -&gt; Secrets ä¸‹é¢æ·»åŠ ï¼ŒName ä¸º<code>CODECOV_TOKEN</code>ï¼ŒValue å°±æ˜¯åˆšåˆšè·å–çš„<code>Codecov Token</code>çš„å€¼ã€‚è¿™æ ·æˆ‘ä»¬å°±å®Œæˆäº† Test è¿™ä¸ª Job ä»»åŠ¡çš„æ“ä½œå£°æ˜ã€‚</p>
<blockquote>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»»ä½•è¯­è¨€åˆ›å»ºè‡ªå·±çš„ actionsï¼ˆåªéœ€è¦åŒ…å«ä¸€ä¸ª Dockerfile æ–‡ä»¶ï¼‰ï¼Œå¦‚æœä½ å–œæ¬¢ä½¿ç”¨ Typescript çš„è¯è¿˜å¯ä»¥ç›´æ¥ä½¿ç”¨å®˜æ–¹æä¾›çš„ action å¼€å‘å·¥å…·åŒ…ï¼š<a href="https://github.com/actions/toolkit">https://github.com/actions/toolkit</a>ã€‚</p>
</blockquote>
<p>è¿™æ ·æˆ‘ä»¬å°±å®Œæˆäº†ç¬¬ä¸€ä¸ª workflowğŸ˜„ï¼Œä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯æˆ‘ä»¬è¿™é‡Œæ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯é€šè¿‡ make å‘½ä»¤æ‰§è¡Œçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸­æ·»åŠ ä¸€ä¸ª Makefile æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>PROJECT_NAME :<span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;github.com/cnych/go-github-actions&#34;</span>
</span></span><span style="display:flex;"><span>PKG :<span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;</span><span style="color:#ff79c6">$(</span>PROJECT_NAME<span style="color:#ff79c6">)</span><span style="color:#f1fa8c">&#34;</span>
</span></span><span style="display:flex;"><span>PKG_LIST :<span style="color:#ff79c6">=</span> <span style="color:#ff79c6">$(</span>shell go list <span style="color:#f1fa8c">${</span><span style="color:#8be9fd;font-style:italic">PKG</span><span style="color:#f1fa8c">}</span>/... | grep -v /vendor/<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>GO_FILES :<span style="color:#ff79c6">=</span> <span style="color:#ff79c6">$(</span>shell find . -name <span style="color:#f1fa8c">&#39;*.go&#39;</span> | grep -v /vendor/ | grep -v _test.go<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>.PHONY: all dep lint vet <span style="color:#8be9fd;font-style:italic">test</span> test-coverage build clean
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>all: build
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>dep: <span style="color:#6272a4">## Get the dependencies</span>
</span></span><span style="display:flex;"><span>	@go mod download
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>lint: <span style="color:#6272a4">## Lint Golang files</span>
</span></span><span style="display:flex;"><span>	@golint -set_exit_status <span style="color:#f1fa8c">${</span><span style="color:#8be9fd;font-style:italic">PKG_LIST</span><span style="color:#f1fa8c">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>vet: <span style="color:#6272a4">## Run go vet</span>
</span></span><span style="display:flex;"><span>	@go vet <span style="color:#f1fa8c">${</span><span style="color:#8be9fd;font-style:italic">PKG_LIST</span><span style="color:#f1fa8c">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>test: <span style="color:#6272a4">## Run unittests</span>
</span></span><span style="display:flex;"><span>	@go <span style="color:#8be9fd;font-style:italic">test</span> -short <span style="color:#f1fa8c">${</span><span style="color:#8be9fd;font-style:italic">PKG_LIST</span><span style="color:#f1fa8c">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>test-coverage: <span style="color:#6272a4">## Run tests with coverage</span>
</span></span><span style="display:flex;"><span>	@go <span style="color:#8be9fd;font-style:italic">test</span> -short -coverprofile cover.out -covermode<span style="color:#ff79c6">=</span>atomic <span style="color:#f1fa8c">${</span><span style="color:#8be9fd;font-style:italic">PKG_LIST</span><span style="color:#f1fa8c">}</span>
</span></span><span style="display:flex;"><span>	@cat cover.out &gt;&gt; coverage.txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>build: dep <span style="color:#6272a4">## Build the binary file</span>
</span></span><span style="display:flex;"><span>	@go build -i -o build/main <span style="color:#ff79c6">$(</span>PKG<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>clean: <span style="color:#6272a4">## Remove previous build</span>
</span></span><span style="display:flex;"><span>	@rm -f ./build
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>help: <span style="color:#6272a4">## Display this help screen</span>
</span></span><span style="display:flex;"><span>	@grep -h -E <span style="color:#f1fa8c">&#39;^[a-zA-Z_-]+:.*?## .*$$&#39;</span> <span style="color:#ff79c6">$(</span>MAKEFILE_LIST<span style="color:#ff79c6">)</span> | awk <span style="color:#f1fa8c">&#39;BEGIN {FS = &#34;:.*?## &#34;}; {printf &#34;\033[36m%-30s\033[0m %s\n&#34;, $$1, $$2}&#39;</span>
</span></span></code></pre></div><p>æ¥ä¸‹æ¥æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„åˆ†æ”¯æ”¹ä¸€ç‚¹ä»£ç ç„¶ååœ¨ Actions ä¸­æŸ¥çœ‹ä¸‹ PR çš„ workflowï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ git checkout -b actions-demo
</span></span><span style="display:flex;"><span>Switched to a new branch <span style="color:#f1fa8c">&#39;actions-demo&#39;</span>
</span></span></code></pre></div><p>ç„¶åä¿®æ”¹ hello è¿™ä¸ª package ä¸‹é¢çš„ Greet å‡½æ•°ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-golang" data-lang="golang"><span style="display:flex;"><span><span style="color:#6272a4">// Greet ... Greet GitHub Actions
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span><span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">Greet</span>() <span style="color:#8be9fd">string</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">return</span> <span style="color:#f1fa8c">&#34;Hello GitHub Actions. qikqiak.com is awesome&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>å½“ç„¶åŒæ ·ä¹Ÿè¦ä¿®æ”¹ä¸‹ hello_test.go ä¸­çš„æµ‹è¯•ä»£ç ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-golang" data-lang="golang"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">TestGreet</span>(t <span style="color:#ff79c6">*</span>testing.T) {
</span></span><span style="display:flex;"><span>  result <span style="color:#ff79c6">:=</span> <span style="color:#50fa7b">Greet</span>()
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">if</span> result <span style="color:#ff79c6">!=</span> <span style="color:#f1fa8c">&#34;Hello GitHub Actions. qikqiak.com is awesome&#34;</span> {
</span></span><span style="display:flex;"><span>	t.<span style="color:#50fa7b">Errorf</span>(<span style="color:#f1fa8c">&#34;Greet() = %s; Expected Hello GitHub Actions. qikqiak.com is awesome&#34;</span>, result)
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>è¦è®°ä½ä¸Šé¢å®šä¹‰çš„ workflow æ–‡ä»¶åŒæ ·è¦æ·»åŠ åˆ°é¡¹ç›®æ ¹ç›®å½•<code>.github/workflows/main.yml</code>æ–‡ä»¶ä¸­ï¼Œç°åœ¨æ¨é€è¿™ä¸ªåˆ†æ”¯ç„¶ååˆ›å»ºä¸€ä¸ª Pull Request åˆ° master åˆ†æ”¯ï¼Œä¸Šé¢æˆ‘ä»¬å®šä¹‰çš„å·¥ä½œæµå°±ä¼šç«‹åˆ»è¢«è§¦å‘æ„å»ºäº†ã€‚è€Œä¸”åœ¨ workflow è¿˜æœªæ‰§è¡Œå®Œæˆé€šè¿‡çš„æ—¶å€™ï¼Œæ˜¯ä¸èƒ½è¿›è¡Œ merge æ“ä½œçš„ã€‚
<img src="https://picdn.youdianzhishi.com/images/github-actions-pr.png" alt="github actions pr check"></p>
<p>å½“ä»»åŠ¡æ‰§è¡Œå®Œæˆåå°±å¯ä»¥è¿›è¡Œ Merge æ“ä½œäº†ï¼š
<img src="https://picdn.youdianzhishi.com/images/github-actions-pr-pass.png" alt="github actions pr pass"></p>
<p>ä¸Šé¢åœ¨ workflow ä¸­æˆ‘ä»¬è¿˜å’Œ CodeCov è¿›è¡Œäº†é›†æˆï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥çœ‹åˆ° PR çš„çŠ¶æ€æ£€æŸ¥å’Œ Coverage ä»£ç è¦†ç›–æŠ¥å‘Šï¼š
<img src="https://picdn.youdianzhishi.com/images/github-actions-codev-report.png" alt="github actions codecov report"></p>
<h3 id="release-workflow">release workflow</h3>
<p>ä¸Šé¢æˆ‘ä»¬å®šä¹‰äº†æ„å»ºæµ‹è¯•çš„ workflowï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥å®šä¹‰æˆ‘ä»¬çš„å‘å¸ƒ workflowï¼Œä½¿ç”¨æ–¹æ³•éƒ½æ˜¯ç±»ä¼¼çš„ï¼Œä¸Šé¢æˆ‘ä»¬ä¹Ÿæåˆ°è¿‡æ¯ä¸ª workflow éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬è¿™é‡Œåˆ›å»ºä¸€ä¸ªæ–‡ä»¶<code>.github/workflows/release.yml</code>ï¼Œå†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#ff79c6">name</span>: Release
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">on</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">create</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">tags</span>:
</span></span><span style="display:flex;"><span>      - v*
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">jobs</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">release</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">name</span>: Release on GitHub
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">runs-on</span>: ubuntu-latest
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">steps</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ff79c6">name</span>: Check out code
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">uses</span>: actions/checkout@v1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ff79c6">name</span>: Validates GO releaser config
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">uses</span>: docker://goreleaser/goreleaser:latest
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">with</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">args</span>: check
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ff79c6">name</span>: Create release on GitHub
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">uses</span>: docker://goreleaser/goreleaser:latest
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">with</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">args</span>: release
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">env</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#ff79c6">GITHUB_TOKEN</span>: ${{secrets.GITHUB_TOKEN}}
</span></span></code></pre></div><p>è¿™ä¸ª workflow ä¸­æˆ‘ä»¬å®šä¹‰äº†åªåœ¨åˆ›å»ºæ–°çš„ tag æ—¶æ‰è§¦å‘ä»»åŠ¡ï¼Œç„¶ååªå®šä¹‰äº†ä¸€ä¸ª release çš„ Jobã€‚</p>
<p>ä¸Šé¢æˆ‘ä»¬å®šä¹‰çš„ Job ä»»åŠ¡ä¸­å…ˆè·å–é¡¹ç›®ä»£ç ï¼Œç„¶åä½¿ç”¨ <a href="https://goreleaser.com/">GoReleaser</a> å®˜æ–¹ Docker é•œåƒæ¥æ„å»ºä»»åŠ¡ã€‚å½“ä½¿ç”¨ docker å®¹å™¨çš„æ—¶å€™ï¼Œå¯ä»¥å®šä¹‰å®¹å™¨çš„<code>args</code>å’Œ<code>entrypoint</code>ï¼Œæˆ‘ä»¬è¿™é‡Œåˆ†åˆ«ä½¿ç”¨<code>args</code>å®šä¹‰äº†<code>check</code>å’Œ<code>release</code>ä¸¤ä¸ªå‚æ•°ã€‚</p>
<p>å¦å¤–è¿˜æŒ‡å®šäº†<code>GoReleaser</code>æ‰€éœ€çš„<code>GITHUB_TOKEN</code>è¿™ä¸ªç¯å¢ƒå˜é‡ï¼Œè¿™æ ·å¯ä»¥åœ¨ GitHub ä¸Šæ¥å‘å¸ƒæˆ‘ä»¬çš„åº”ç”¨ç‰ˆæœ¬ï¼Œä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>secrets.GITHUB_TOKEN</code>è¿™ä¸ªå˜é‡çš„å€¼æ˜¯ç”± Actions å¹³å°è‡ªåŠ¨æ³¨å…¥çš„ï¼Œæ‰€ä»¥ä¸éœ€è¦æˆ‘ä»¬å•ç‹¬æ‰‹åŠ¨å»æ·»åŠ äº†ï¼Œè¿™æ ·å°±æ–¹ä¾¿å¾ˆå¤šäº†ã€‚</p>
<p>ç„¶åæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„ tag å¹¶æ¨é€åˆ°ä»£ç ä»“åº“ä¸­å»ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ git tag v0.1.0
</span></span><span style="display:flex;"><span>$ git push --tags
</span></span><span style="display:flex;"><span>Counting objects: 5, <span style="color:#ff79c6">done</span>.
</span></span><span style="display:flex;"><span>Writing objects: 100% <span style="color:#ff79c6">(</span>5/5<span style="color:#ff79c6">)</span>, <span style="color:#bd93f9">799</span> bytes | <span style="color:#bd93f9">0</span> bytes/s, <span style="color:#ff79c6">done</span>.
</span></span><span style="display:flex;"><span>Total <span style="color:#bd93f9">5</span> <span style="color:#ff79c6">(</span>delta 0<span style="color:#ff79c6">)</span>, reused <span style="color:#bd93f9">0</span> <span style="color:#ff79c6">(</span>delta 0<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>To git@github.com:cnych/go-github-actions.git
</span></span><span style="display:flex;"><span> * <span style="color:#ff79c6">[</span>new tag<span style="color:#ff79c6">]</span>         v0.1.0 -&gt; v0.1.0
</span></span></code></pre></div><p>å¦‚æœä¸€åˆ‡æ­£å¸¸å°±ä¼šç«‹åˆ»è§¦å‘ä»»åŠ¡æ„å»ºï¼ŒJob ä»»åŠ¡æ„å»ºå®Œæˆåä¼šåœ¨ GitHub ä¸Šé¢åˆ›å»ºä¸€ä¸ªæ–°çš„ç‰ˆæœ¬ï¼Œå…¶ä¸­åŒ…å«ç”±<code>GoReleaser</code>å·¥å…·è‡ªåŠ¨ç”Ÿæˆçš„åº”ç”¨åŒ…å’Œ Changelogã€‚</p>
<p><img src="https://picdn.youdianzhishi.com/images/github-actions-release.png" alt="github actions release"></p>
<p>åˆ°è¿™é‡Œæˆ‘ä»¬å°±å®Œæˆäº†ç¬¬ä¸€ä¸ª GitHub Actions çš„ PipelineğŸ˜„ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸åŸºç¡€çš„ä¾‹å­ï¼Œä½†æ˜¯å¯¹äºæˆ‘ä»¬äº†è§£ GitHub Actions çš„å·¥ä½œæ–¹å¼æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ¡ˆä¾‹ã€‚</p>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>å¯¹äºå¤§éƒ¨åˆ†æ‰˜ç®¡åœ¨ GitHub ä¸Šçš„å¼€æºé¡¹ç›®ï¼ŒGitHub Actions åº”è¯¥è¶³å¤Ÿäº†ï¼Œå¯¹äºæ›´é«˜çº§çš„ç”¨æ³•ï¼Œæ¯”å¦‚æ‰‹åŠ¨æ‰¹å‡†å’Œå‚æ•°åŒ–æ„å»ºè¿™äº›ä¼ä¸šé¡¹ç›®ä¼šç»å¸¸ä½¿ç”¨çš„åŠŸèƒ½ç›®å‰è¿˜ä¸æ”¯æŒï¼Œä¸è¿‡ GitHub Actions ç°åœ¨è¿˜å¤„äºæµ‹è¯•é˜¶æ®µï¼Œæˆ–è®¸ä¸ä¹…çš„å°†æ¥å°±ä¼šæ”¯æŒè¿™äº›åŠŸèƒ½äº†ï¼Œå¯¹äº Jenkinsã€GitLab CI è¿™äº›åœ¨ä¼ä¸šä¸­éå¸¸å—æ¬¢è¿çš„å·¥å…·æ¥è¯´å½±å“æˆ–è®¸ä¸å¤§ï¼Œä½†æ˜¯å¯¹äºä¸€äº›ä¾èµ– GitHub çš„ç¬¬ä¸‰æ–¹ CI/CD å·¥å…·å½±å“å°±å¾ˆå¤§äº†ï¼Œæ¯”å¦‚ Travis CI æˆ–è€… Circle CI ä¹‹ç±»çš„ï¼Œå› ä¸ºå¯¹äºæ‰˜ç®¡åœ¨ GitHub ä¸Šé¢çš„é¡¹ç›®æ¥è¯´ GitHub Actions å·²ç»è¶³å¤Ÿä¼˜ç§€äº†ï¼Œæ›´é‡è¦çš„æ˜¯å±äºå†…ç½®çš„åŠŸèƒ½ï¼Œæ‰€ä»¥å‰é¢è¯´ Travis CI ç°åœ¨åœ¨æŸä¸ªå¢™è§’ç‘Ÿç‘Ÿå‘æŠ– ğŸ¤£ ä¸æ˜¯æ²¡æœ‰é“ç†çš„ã€‚</p>
<h2 id="å‚è€ƒæ–‡æ¡£">å‚è€ƒæ–‡æ¡£</h2>
<ul>
<li><a href="https://github.com/features/actions">Features â€¢ GitHub Actions</a></li>
<li><a href="https://help.github.com/en/articles/workflow-syntax-for-github-actions">Workflow syntax for GitHub Actions
</a></li>
<li><a href="https://dev.to/brpaz/building-a-basic-ci-cd-pipeline-for-a-golang-application-using-github-actions-icj">Building a basic CI/CD pipeline for a Golang application using GitHub Actions</a></li>
</ul>
<!-- raw HTML omitted -->

          <h2>å¾®ä¿¡å…¬ä¼—å·</h2>
<p>
  æ‰«æä¸‹é¢çš„äºŒç»´ç å…³æ³¨æˆ‘ä»¬çš„å¾®ä¿¡å…¬ä¼—å¸å·ï¼Œåœ¨å¾®ä¿¡å…¬ä¼—å¸å·ä¸­å›å¤â—‰åŠ ç¾¤â—‰å³å¯åŠ å…¥åˆ°æˆ‘ä»¬çš„
  kubernetes è®¨è®ºç¾¤é‡Œé¢å…±åŒå­¦ä¹ ã€‚
</p>
<img
  src="https://picdn.youdianzhishi.com/images/qrcode.png"
  alt="wechat-account-qrcode"
/>

  
          
            <div class="entry-shang text-center">
    <p>ã€ŒçœŸè¯šèµèµï¼Œæ‰‹ç•™ä½™é¦™ã€</p>
    <button class="zs show-zs btn btn-bred">èµèµ</button>
</div>
<div class="zs-modal-bg"></div>
<div class="zs-modal-box">
    <div class="zs-modal-head">
        <button type="button" class="close">Ã—</button>
        <span class="author"><img src="https://www.qikqiak.com/img/avatar.jpeg"/>é˜³æ˜</span>
        <p class="tip"><i></i><span>è¯·æˆ‘å–æ¯å’–å•¡ï¼Ÿ</span></p>
    </div>
    <div class="zs-modal-body">
        <div class="zs-modal-btns">
            <button class="btn btn-blink" data-num="2">2å…ƒ</button>
            <button class="btn btn-blink" data-num="5">5å…ƒ</button>
            <button class="btn btn-blink" data-num="10">10å…ƒ</button>
            <button class="btn btn-blink" data-num="50">50å…ƒ</button>
            <button class="btn btn-blink" data-num="100">100å…ƒ</button>
            <button class="btn btn-blink" data-num="1">ä»»æ„é‡‘é¢</button>
        </div>
        <div class="zs-modal-pay">
            <button class="btn btn-bred" id="pay-text">2å…ƒ</button>
            <p>ä½¿ç”¨<span id="pay-type">å¾®ä¿¡</span>æ‰«æäºŒç»´ç å®Œæˆæ”¯ä»˜</p>
            <img src="https://www.qikqiak.com/img/wechat-2.png" id="pay-image"/>
        </div>
    </div>
    <div class="zs-modal-footer">
        <span class="zs-wechat"><img src="https://www.qikqiak.com/img/wechat-btn.png"/></span>
    </div>
</div>
          
          
            <div class="social-share" data-initialized="true" style="margin-bottom: 20px;margin-top:20px;">
    <center>
    <a href="#" class="social-share-icon icon-weibo"></a>
    <a href="#" class="social-share-icon icon-wechat"></a>
    <a href="#" class="social-share-icon icon-twitter"></a>
    <a href="#" class="social-share-icon icon-linkedin"></a>
    <a href="#" class="social-share-icon icon-facebook"></a>
    <a href="#" class="social-share-icon icon-qq"></a>
    <a href="#" class="social-share-icon icon-qzone"></a>
    </center>
</div>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script>

          
        </article>
  
        
          

<h3>ç›¸å…³æ–‡ç« </h3>
<ul style="margin-bottom: 25px;">
    
    <li><a href="https://www.qikqiak.com/post/kubernetes-jenkins3/">Jenkins Blue Ocean çš„ä½¿ç”¨</a></li>
    
    <li><a href="https://www.qikqiak.com/post/kubernetes-jenkins2/">Jenkins Pipeline éƒ¨ç½² Kubernetes åº”ç”¨(äºŒ)</a></li>
    
    <li><a href="https://www.qikqiak.com/post/drone-with-k8s-3/">Drone ç»“åˆ Helm éƒ¨ç½² Kubernetes åº”ç”¨</a></li>
    
    <li><a href="https://www.qikqiak.com/post/drone-with-k8s-2/">ä½¿ç”¨ Drone Pipeline æ„å»º Docker é•œåƒ</a></li>
    
    <li><a href="https://www.qikqiak.com/post/drone-with-k8s-1/">ä½¿ç”¨ Kubernetes Helm å®‰è£… Drone</a></li>
    
    <li><a href="https://www.qikqiak.com/post/kubernetes-jenkins1/">åŸºäº kubernetes çš„åŠ¨æ€ jenkins slave</a></li>
    
    <li><a href="https://www.qikqiak.com/post/install-kubesphere-on-k8s/">åœ¨ç°æœ‰ Kubernetes é›†ç¾¤ä¸Šå®‰è£… KubeSphere</a></li>
    
    <li><a href="https://www.qikqiak.com/post/go-modules-usage/">Go Modules åŸºæœ¬ä½¿ç”¨ï¼ˆè§†é¢‘ï¼‰</a></li>
    
    <li><a href="https://www.qikqiak.com/post/k8s-auth-via-oidc/">é€šè¿‡ GitHub OAuth å’Œ Dex è®¿é—® Kubernetes é›†ç¾¤</a></li>
    
    <li><a href="https://www.qikqiak.com/post/groovy-simple-tutorial/">Groovy ç®€æ˜æ•™ç¨‹</a></li>
    
</ul>

        
  
        
        <ul class="pager blog-pager">
          
            <li class="previous">
              <a href="https://www.qikqiak.com/post/kustomize-101/" data-toggle="tooltip" data-placement="top" title="ä½¿ç”¨ Kustomize é…ç½® Kubernetes åº”ç”¨">&larr; å‰ä¸€ç¯‡</a>
            </li>
          
          
            <li class="next">
              <a href="https://www.qikqiak.com/post/use-kubeadm-install-kubernetes-1.15.3/" data-toggle="tooltip" data-placement="top" title="ä½¿ç”¨ kubeadm æ­å»º v1.15.3 ç‰ˆæœ¬ Kubernetes é›†ç¾¤">åä¸€ç¯‡ &rarr;</a>
            </li>
          
        </ul>
        

        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        
        <ins class="adsbygoogle"
            style="display:block"
            data-ad-client="ca-pub-5376999672787220"
            data-ad-slot="3700507799"
            data-ad-format="auto"
            data-full-width-responsive="true"></ins>
        <script>
            (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
  
        
    <div id="gitalk-container"></div>
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>
    var gitalk = new Gitalk({
        clientID: 'bdb76dbb2e9d0786e350',
        clientSecret: 'b454b2a08013fd0e32013be7a63fa8fcb262b6c4',
        repo: 'blog',
        owner: 'cnych',
        admin: ['cnych'],
        labels: ['gitment'],
        title: 'ä½¿ç”¨ GitHub Actions è‡ªåŠ¨åŒ–æ„å»º Golang åº”ç”¨',
        createIssueManually: true,
        id: 'use-github-actions-build-go-app',      
        distractionFreeMode: true  
    });
    gitalk.render('gitalk-container');
</script>


        
          

        
  
      </div>
    
    
  </div>
</div>

    <footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          <img src="https://www.qikqiak.com/img/wechatmp.png" alt="k8sæŠ€æœ¯åœˆ">
          
              <li>
                <a href="mailto:icnych@gmail.com" title="Email me">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
              <li>
                <a href="https://github.com/cnych" title="GitHub">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
              <li>
                <a href="https://weibo.com/cnych" title="å¾®åš">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-weibo fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
              <li>
                <a href="https://instagram.com/cnych" title="Instagram">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-instagram fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
          
          <li>
            <a href="https://www.qikqiak.com/index.xml" title="RSS">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
        </ul>
        <p class="credits copyright text-muted">
          

          &nbsp;&bull;&nbsp;
          2023

          
            &nbsp;&bull;&nbsp;
            <a href="https://www.qikqiak.com/">é˜³æ˜çš„åšå®¢</a>
            &nbsp;&bull;&nbsp;
            <a href="https://www.qikqiak.com/sitemap.xml">ç½‘ç«™åœ°å›¾</a>
            &nbsp;&bull;&nbsp;
            <a href="https://www.qikqiak.com/page/archive/">å½’æ¡£</a>
            &nbsp;&bull;&nbsp;
            <a href="https://www.qikqiak.com/page/friend/">å‹é“¾</a>
            &nbsp;&bull;&nbsp;
            <a href="https://beian.miit.gov.cn/" target="_blank">èœ€ICPå¤‡11027319å·-5</a>
            <a class="h" href="https://www.qikqiak.com/page/kubernetes.io">kubernetes.io</a>
            <a class="h" href="https://www.qikqiak.com/page/kubernetes.org.cn">Kubernetesä¸­æ–‡ç¤¾åŒº</a>
          
        </p>
        <p class="text-center text-muted">
          <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
          <span id="busuanzi_container_site_pv" style="display:none">
            æœ¬ç«™æ€»è®¿é—®é‡<span id="busuanzi_value_site_pv"></span>æ¬¡
          </span>
          &nbsp;&bull;&nbsp;
          <span id="busuanzi_container_site_uv" style="display:none">
            è®¿å®¢æ•°<span id="busuanzi_value_site_uv"></span>äººæ¬¡
          </span>
        </p>
        
        <p class="credits theme-by text-muted">
          ç”± <a href="http://gohugo.io">Hugo v0.115.4</a> å¼ºåŠ›é©±åŠ¨ &nbsp;&bull;&nbsp; ä¸»é¢˜ <a href="https://github.com/cnych/qikqiak.com">qikqiak-blog</a>
          
        </p>
      </div>
    </div>
  </div>
</footer>


<script src='https://www.qikqiak.com/js/bundle.min.af02a2d23b6651a566f0135a12e65fc2560faa7a969b3d1ad58d0afe0c9164ae.js' integrity='sha256-rwKi0jtmUaVm8BNaEuZfwlYPqnqWmz0a1Y0K/gyRZK4='></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=UA-69668147-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-69668147-3');
</script>
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<script >
$(document).ready(function() {
  var int = setInterval(fixCount, 50);  
  
  var initPVCount = 584976;
  var initUVCount = 153191;
  function fixCount() {                   
    if ($("#busuanzi_container_site_pv").css("display") != "none") {
        $("#busuanzi_value_site_pv").html(parseInt($("#busuanzi_value_site_pv").html()) + initPVCount); 
        clearInterval(int); 
    }
    if ($("#busuanzi_container_site_uv").css("display") != "none") {
      $("#busuanzi_value_site_uv").html(parseInt($("#busuanzi_value_site_uv").html()) + initUVCount);
      clearInterval(int); 
    }  
  }           
});
</script>
 <script>(function(w,d, s, id) {if(typeof(w.webpushr)!=='undefined') return;w.webpushr=w.webpushr||function(){(w.webpushr.q=w.webpushr.q||[]).push(arguments)};var js, fjs = d.getElementsByTagName(s)[0];js = d.createElement(s); js.id = id;js.src = "https://cdn.webpushr.com/app.min.js";fjs.parentNode.appendChild(js);}(window,document, 'script', 'webpushr-jssdk'));webpushr('init','BJICPtxnbz-7vq9kEwH5psPCuHe2CvludQug4R2tuJGPF0GQT2hwSWTAhlSt2EFD5InpuQyxCGJdigf6-KbQ53c');</script>
<script type="text/javascript" src="//cdn.jsdelivr.net/npm/jquery-migrate@1.2.1/dist/jquery-migrate.min.js"></script>
<script type="text/javascript" src="//cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js"></script>
<script type="text/javascript">
$('.carousel').slick({
    dots: true,
    arrows: true,
    autoplay: true,
    autoplaySpeed: 4000,
    infinite: true,
    speed: 500,
    fade: true,
    cssEase: 'linear',
    centerMode: true,
    prevArrow: '<button type="button" class="slick-prev"></button>',
    nextArrow: '<button type="button" class="slick-next"></button>',
});
</script>

  </body>
</html>

