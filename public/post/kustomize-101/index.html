<!DOCTYPE html>
<html lang="zh">
  <head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">


  <title>ä½¿ç”¨ Kustomize é…ç½® Kubernetes åº”ç”¨-é˜³æ˜çš„åšå®¢|Kubernetes|Istio|Prometheus|Python|Golang|äº‘åŸç”Ÿ</title>
  <meta property="og:title" content="ä½¿ç”¨ Kustomize é…ç½® Kubernetes åº”ç”¨" />
  <meta name="twitter:title" content="ä½¿ç”¨ Kustomize é…ç½® Kubernetes åº”ç”¨" />

  <meta name="description" content="å¦‚æœä½ ç»å¸¸ä½¿ç”¨ Kubernetesï¼Œé‚£ä¹ˆä½ è‚¯å®šå°±æœ‰å®šåˆ¶èµ„æºæ¸…å•æ–‡ä»¶çš„éœ€æ±‚ï¼Œä½†æ˜¯è²Œä¼¼ç°åœ¨å¤§å®¶éƒ½æ¯”è¾ƒå–œæ¬¢ä½¿ç”¨ Helmï¼ŒHelm å¾ˆå¥½ç”¨ï¼Œä½†ä¹Ÿæœ‰å¾ˆå¤šç¼ºç‚¹ï¼Œæ¯”å¦‚éœ€è¦ä¸€ä¸ª tiller æœåŠ¡ç«¯ï¼Œéœ€è¦è¶…é«˜çš„æƒé™ï¼Œæœ€é‡è¦çš„æ˜¯å¦‚æœä½ è¦æƒ³è‡ªå·±åšä¸€ä¸ª Helm Chart åŒ…çš„è¯ï¼Œåˆ™ä¸æ˜¯é‚£ä¹ˆå®¹æ˜“çš„ï¼Œéœ€è¦ä½ äº†è§£ä¸€äº› go template çš„ç›¸å…³çŸ¥è¯†ï¼Œå®ƒæŠ›å¼ƒäº†æˆ‘ä»¬åœ¨ Docker å’Œ Kubernetes ä¸Šé¢å­¦åˆ°çš„ä¸€äº›é€»è¾‘ï¼Œä»Šå¤©æˆ‘ä»¬å°†ä¸ºå¤§å®¶ä»‹ç»å¦å¤–ä¸€ç§åä¸ºKustomizeâ¤ï¸çš„æ›¿ä»£å·¥å…·ã€‚">
  <meta property="og:description" content="å¦‚æœä½ ç»å¸¸ä½¿ç”¨ Kubernetesï¼Œé‚£ä¹ˆä½ è‚¯å®šå°±æœ‰å®šåˆ¶èµ„æºæ¸…å•æ–‡ä»¶çš„éœ€æ±‚ï¼Œä½†æ˜¯è²Œä¼¼ç°åœ¨å¤§å®¶éƒ½æ¯”è¾ƒå–œæ¬¢ä½¿ç”¨ Helmï¼ŒHelm å¾ˆå¥½ç”¨ï¼Œä½†ä¹Ÿæœ‰å¾ˆå¤šç¼ºç‚¹ï¼Œæ¯”å¦‚éœ€è¦ä¸€ä¸ª tiller æœåŠ¡ç«¯ï¼Œéœ€è¦è¶…é«˜çš„æƒé™ï¼Œæœ€é‡è¦çš„æ˜¯å¦‚æœä½ è¦æƒ³è‡ªå·±åšä¸€ä¸ª Helm Chart åŒ…çš„è¯ï¼Œåˆ™ä¸æ˜¯é‚£ä¹ˆå®¹æ˜“çš„ï¼Œéœ€è¦ä½ äº†è§£ä¸€äº› go template çš„ç›¸å…³çŸ¥è¯†ï¼Œå®ƒæŠ›å¼ƒäº†æˆ‘ä»¬åœ¨ Docker å’Œ Kubernetes ä¸Šé¢å­¦åˆ°çš„ä¸€äº›é€»è¾‘ï¼Œä»Šå¤©æˆ‘ä»¬å°†ä¸ºå¤§å®¶ä»‹ç»å¦å¤–ä¸€ç§åä¸ºKustomizeâ¤ï¸çš„æ›¿ä»£å·¥å…·ã€‚">
  <meta name="twitter:description" content="å¦‚æœä½ ç»å¸¸ä½¿ç”¨ Kubernetesï¼Œé‚£ä¹ˆä½ è‚¯å®šå°±æœ‰å®šåˆ¶èµ„æºæ¸…å•æ–‡ä»¶çš„éœ€æ±‚ï¼Œä½†æ˜¯è²Œä¼¼ç°åœ¨å¤§å®¶éƒ½æ¯”è¾ƒå–œæ¬¢ä½¿ç”¨ Helmï¼ŒHelm å¾ˆå¥½ç”¨ï¼Œä½†ä¹Ÿæœ‰å¾ˆå¤šç¼ºç‚¹ï¼Œæ¯”å¦‚éœ€è¦ä¸€ä¸ª tiller æœåŠ¡ç«¯ï¼Œéœ€è¦è¶…é«˜çš„æƒé™ï¼Œæœ€é‡è¦çš„æ˜¯å¦‚æœä½ è¦æƒ³è‡ªå·±åšä¸€ä¸ª Helm Chart åŒ…çš„è¯ï¼Œåˆ™ä¸æ˜¯é‚£ä¹ˆå®¹æ˜“çš„ï¼Œéœ€è¦ä½ äº†è§£ä¸€äº› go template çš„ç›¸å…³çŸ¥è¯†ï¼Œå®ƒæŠ›å¼ƒäº†æˆ‘ä»¬åœ¨ Docker å’Œ Kubernetes ä¸Šé¢å­¦åˆ° â€¦">
  <meta name="author" content=""/>
  <link href='https://bxdc-static.oss-cn-beijing.aliyuncs.com/images/favicon.png' rel='icon' type='image/x-icon'/>
  <link rel="apple-touch-icon" href="https://bxdc-static.oss-cn-beijing.aliyuncs.com/images/favicon.png"/>
  <meta property="og:image" content="https://www.qikqiak.com/img/avatar.jpeg" />
  <meta name="twitter:image" content="https://www.qikqiak.com/img/avatar.jpeg" />
  <meta name="twitter:card" content="summary" />
  <meta property="og:url" content="https://www.qikqiak.com/post/kustomize-101/" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="é˜³æ˜çš„åšå®¢" />

  <meta name="generator" content="Hugo 0.53" />
  <link rel="canonical" href="https://www.qikqiak.com/post/kustomize-101/" />
  <link rel="alternate" href="https://www.qikqiak.com/index.xml" type="application/rss+xml" title="é˜³æ˜çš„åšå®¢">

  
  
  <link href="https://fonts.googleapis.com/css?family=Lora:400,400i,700%7COpen+Sans:400,700" rel="stylesheet">
  

  <link rel="stylesheet" href='https://www.qikqiak.com/css/bundle.min.dda6a253747d6ead5b02b78e8b25e18211ff59ab4aaee4a95698ab96a5c63f37.css' integrity='sha256-3aaiU3R9bq1bAreOiyXhghH/WatKruSpVpirlqXGPzc='>

  
    
    <!--[if lt IE 9]>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js"></script>
        <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <![endif]-->
<meta name="google-site-verification" content="oKxX4fOvB2yYmU02txZFChM93XQbESU4JaG3tNH9Hm8" />
<meta name="baidu-site-verification" content="F5ojAyqaKU" />
<meta name="keywords" content="kubernetes, helm, kustomize, æ¨¡æ¿">
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?d611849735f187dd788dc054908f7d7a";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>



<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-69668147-3', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</head>

  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">åˆ‡æ¢å¯¼èˆª</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://www.qikqiak.com/">é˜³æ˜çš„åšå®¢</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li>
              <a title="é¦–é¡µ" href="https://www.qikqiak.com/">é¦–é¡µ</a>
            </li>
          
        
          
            <li>
              <a title="è¯¾ç¨‹" href="https://youdianzhishi.com/?utm_source=blog&amp;utm_campaign=referral&amp;utm_medium=topmenu">è¯¾ç¨‹</a>
            </li>
          
        
          
            <li class="navlinks-container">
              <a class="navlinks-parent" href="javascript:void(0)">æ–‡ç« åˆ†ç±»</a>
              <div class="navlinks-children">
                
                  <a href="https://www.qikqiak.com/archives">Archive</a>
                
                  <a href="https://www.qikqiak.com/tags">tags</a>
                
                  <a href="https://www.qikqiak.com/tags/kubernetes">kubernetes</a>
                
                  <a href="https://www.qikqiak.com/tags/python">python</a>
                
                  <a href="https://www.qikqiak.com/tags/django">django</a>
                
                  <a href="https://www.qikqiak.com/tags/ops">devops</a>
                
              </div>
            </li>
          
        
          
            <li class="navlinks-container">
              <a class="navlinks-parent" href="javascript:void(0)">ä¹¦ç±</a>
              <div class="navlinks-children">
                
                  <a href="https://www.qikqiak.com/k8s-book/">k8sè¿›é˜¶æ‰‹å†Œ</a>
                
                  <a href="https://www.qikqiak.com/istio-book/">ä¸€èµ·å­¦istio</a>
                
                  <a href="https://www.qikqiak.com/tdd-book/">Pythonå¾®æœåŠ¡</a>
                
                  <a href="https://md.qikqiak.com/">Markdownå¾®ä¿¡</a>
                
              </div>
            </li>
          
        
          
            <li>
              <a title="å…³äº" href="https://www.qikqiak.com/page/about/">å…³äº</a>
            </li>
          
        

        

        

        
          <li>
            <a href="#modalSearch" data-toggle="modal" data-target="#modalSearch" style="outline: none;">
              <span id="searchGlyph" class="glyphicon glyphicon-search"></span>
            </a>
          </li>
          

      </ul>
    </div>

  </div>
</nav>





  <div id="modalSearch" class="modal fade" role="dialog">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">æœç´¢</h4>
        </div>
        <div class="modal-body">
            
<div class="aa-input-container" id="aa-input-container">
    <input type="search" id="aa-search-input" class="aa-input-search" placeholder="Search for titles or URIs..." name="search" autocomplete="off" />
    <svg class="aa-input-icon" viewBox="654 -372 1664 1664">
        <path d="M1806,332c0-123.3-43.8-228.8-131.5-316.5C1586.8-72.2,1481.3-116,1358-116s-228.8,43.8-316.5,131.5  C953.8,103.2,910,208.7,910,332s43.8,228.8,131.5,316.5C1129.2,736.2,1234.7,780,1358,780s228.8-43.8,316.5-131.5  C1762.2,560.8,1806,455.3,1806,332z M2318,1164c0,34.7-12.7,64.7-38,90s-55.3,38-90,38c-36,0-66-12.7-90-38l-343-342  c-119.3,82.7-252.3,124-399,124c-95.3,0-186.5-18.5-273.5-55.5s-162-87-225-150s-113-138-150-225S654,427.3,654,332  s18.5-186.5,55.5-273.5s87-162,150-225s138-113,225-150S1262.7-372,1358-372s186.5,18.5,273.5,55.5s162,87,225,150s113,138,150,225  S2062,236.7,2062,332c0,146.7-41.3,279.7-124,399l343,343C2305.7,1098.7,2318,1128.7,2318,1164z" />
    </svg>
</div>
<script src="https://www.qikqiak.com/js/algoliasearch.min.js"></script>
<script src="https://www.qikqiak.com/js/autocomplete.min.js"></script>

<script>
var client = algoliasearch("1JDRAS0AZR", "8804ac109158bb3bb60d74ce98fa332f");
var index = client.initIndex('prod_blog');

autocomplete('#aa-search-input',
{ hint: false}, {
    source: autocomplete.sources.hits(index, {hitsPerPage: 5}),
    
    displayKey: 'name',
    
    templates: {
        
        suggestion: function(suggestion) {
            return '<span>' + '<a href="https://www.qikqiak.com/post/' + suggestion.slug + '">' +
            suggestion._highlightResult.title.value + '</a></span>';
        }
    }
});
</script>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">close</button>
        </div>
      </div>
    </div>
  </div>

    
  
  
  




  
    <div id="header-big-imgs" data-num-img=1 data-img-src-1="https://bxdc-static.oss-cn-beijing.aliyuncs.com/images/photo-1565780421727-543646cefafb.jpeg" data-img-desc-1="Out of a foggy and windless Hindmarsh Island sunrise"></div>
  

  <header class="header-section has-img">
    
      <div class="intro-header big-img">
        
        <div class="container">
          <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
              <div class="post-heading">
                <span class="heading-h1">ä½¿ç”¨ Kustomize é…ç½® Kubernetes åº”ç”¨</span>
                  
                  
                    <span class="post-meta">
  
    å‘è¡¨äº August 16, 2019
  
  
</span>


                  
              </div>
            </div>
          </div>
        </div>
        <span class="img-desc" style="display: inline;"></span>
      </div>
    
    
    <div class="intro-header no-img">
      
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="post-heading">
              <span class="heading-h1">ä½¿ç”¨ Kustomize é…ç½® Kubernetes åº”ç”¨</span>
                
                
                  <span class="post-meta">
  
    å‘è¡¨äº August 16, 2019
  
  
</span>


                
            </div>
          </div>
        </div>
      </div>
    </div>
    
  </header>


    



<div class="container" role="main">
  <div class="row">

    
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div>
            
            
            <h5 id="tags" style="margin-top: 30px;">æ ‡ç­¾:
              
                  <a href="https://www.qikqiak.com/tags/kubernetes/">kubernetes</a> &nbsp;
              
                  <a href="https://www.qikqiak.com/tags/helm/">helm</a> &nbsp;
              
                  <a href="https://www.qikqiak.com/tags/kustomize/">kustomize</a> &nbsp;
              
            </h5>
            
        </div>
  
        <article role="main" class="blog-post" itemprop="articleBody" id="content">
          
            
<aside class="toc">
  <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#å®‰è£…">å®‰è£…</a></li>
<li><a href="#åŸºç¡€æ¨¡æ¿">åŸºç¡€æ¨¡æ¿</a></li>
<li><a href="#å®šåˆ¶">å®šåˆ¶</a>
<ul>
<li><a href="#å®šä¹‰ç¯å¢ƒå˜é‡">å®šä¹‰ç¯å¢ƒå˜é‡</a></li>
<li><a href="#ä¿®æ”¹å‰¯æœ¬æ•°é‡">ä¿®æ”¹å‰¯æœ¬æ•°é‡</a></li>
<li><a href="#é€šè¿‡å‘½ä»¤è¡Œå®šä¹‰-secret">é€šè¿‡å‘½ä»¤è¡Œå®šä¹‰ secret</a></li>
<li><a href="#ä¿®æ”¹é•œåƒ">ä¿®æ”¹é•œåƒ</a></li>
</ul></li>
<li><a href="#æ€»ç»“">æ€»ç»“</a></li>
<li><a href="#å‚è€ƒæ–‡æ¡£">å‚è€ƒæ–‡æ¡£</a></li>
</ul></li>
</ul>
</nav>
</aside>

          
  
          
          
          
  
          
          
          
  
          
          
          

          <p>å¦‚æœä½ ç»å¸¸ä½¿ç”¨ Kubernetesï¼Œé‚£ä¹ˆä½ è‚¯å®šå°±æœ‰å®šåˆ¶èµ„æºæ¸…å•æ–‡ä»¶çš„éœ€æ±‚ï¼Œä½†æ˜¯è²Œä¼¼ç°åœ¨å¤§å®¶éƒ½æ¯”è¾ƒå–œæ¬¢ä½¿ç”¨ Helmï¼ŒHelm å¾ˆå¥½ç”¨ï¼Œä½†ä¹Ÿæœ‰å¾ˆå¤šç¼ºç‚¹ï¼Œæ¯”å¦‚éœ€è¦ä¸€ä¸ª tiller æœåŠ¡ç«¯ï¼Œéœ€è¦è¶…é«˜çš„æƒé™ï¼Œæœ€é‡è¦çš„æ˜¯å¦‚æœä½ è¦æƒ³è‡ªå·±åšä¸€ä¸ª Helm Chart åŒ…çš„è¯ï¼Œåˆ™ä¸æ˜¯é‚£ä¹ˆå®¹æ˜“çš„ï¼Œéœ€è¦ä½ äº†è§£ä¸€äº› go template çš„ç›¸å…³çŸ¥è¯†ï¼Œå®ƒæŠ›å¼ƒäº†æˆ‘ä»¬åœ¨ Docker å’Œ Kubernetes ä¸Šé¢å­¦åˆ°çš„ä¸€äº›é€»è¾‘ï¼Œä»Šå¤©æˆ‘ä»¬å°†ä¸ºå¤§å®¶ä»‹ç»å¦å¤–ä¸€ç§åä¸º<code>Kustomizeâ¤ï¸</code>çš„æ›¿ä»£å·¥å…·ã€‚</p>

<p>å®é™…ä¸Š Kustomize å¹¶ä¸æ˜¯ä¸€ä¸ªæ–°çš„å·¥å…·ï¼Œè€Œä¸”ç°åœ¨å·²ç»è¢«é›†æˆåœ¨äº† kubectl 1.14 ç‰ˆæœ¬çš„å­å‘½ä»¤ä¸­äº†ï¼Œæ˜¯ä¸æ˜¯éå¸¸æ–¹ä¾¿äº†ï¼Œå…å»äº†å®‰è£…ç¬¬ä¸‰æ–¹å·¥å…·çš„éº»çƒ¦ï¼Œå› ä¸º kubectl å·¥å…·åŸºæœ¬ä¸Šæ˜¯æˆ‘ä»¬å¤©å¤©éƒ½åœ¨ä½¿ç”¨çš„ï¼Œæ‰€ä»¥&hellip;&hellip;ä½ å¯ä»¥æŠŠ Helm å‘½ä»¤æ‰”æ‰äº†ğŸ˜‰ã€‚</p>

<p>Kustomize å’Œ Kubernetes ä¸€æ ·ï¼Œå®ƒå®Œå…¨å°±æ˜¯å£°æ˜å¼çš„ï¼Œä½ è¯´ä½ æƒ³è¦ä»€ä¹ˆï¼Œç³»ç»Ÿå°±æä¾›ç»™ä½ ä»€ä¹ˆï¼Œä¸éœ€è¦éµå¾ªå‘½ä»¤æ–¹å¼æ¥æè¿°ä½ å¸Œæœ›æ„å»ºçš„å¯¹è±¡ã€‚</p>

<p>å…¶æ¬¡ï¼Œå®ƒå’Œ Docker æ¯”è¾ƒç±»ä¼¼ï¼Œæœ‰å¾ˆå¤šå±‚ç»„æˆï¼Œæ¯ä¸ªå±‚éƒ½æ˜¯ä¿®æ”¹ä»¥å‰çš„å±‚ï¼Œæ­£å› ä¸ºæœ‰è¿™ä¸ªç†å¿µå­˜åœ¨ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¸æ–­åœ¨å…¶ä»–äººè‡³ä¸Šå†™ä¸œè¥¿ï¼Œè€Œä¸ä¼šå¢åŠ é…ç½®çš„å¤æ‚æ€§ï¼Œæ„å»ºçš„æœ€ç»ˆç»“æœç”±åŸºç¡€éƒ¨åˆ†å’Œä½ åœ¨ä¸Šé¢é…ç½®çš„å…¶ä»–å±‚ç»„æˆã€‚</p>

<figure><img src="https://bxdc-static.oss-cn-beijing.aliyuncs.com/images/kubernetes-kustomize.jpg" alt="kubernetes kustomize"><figcaption>kubernetes kustomize</figcaption></figure>

<p>æœ€åï¼Œå’Œ Git ä¸€æ ·ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªè¿œç¨‹çš„åŸºç¡€é…ç½®ä½œä¸ºæœ€åŸå§‹çš„é…ç½®ï¼Œç„¶ååœ¨è¯¥åŸºç¡€ä¸Šæ·»åŠ ä¸€äº›è‡ªå®šä¹‰çš„é…ç½®ã€‚</p>

<h2 id="å®‰è£…">å®‰è£…</h2>

<p>å¯¹äº ğŸMac ç”¨æˆ·æ¥è¯´ï¼Œä½ å¯ä»¥ä½¿ç”¨ brew å·¥å…·æ¥ç›´æ¥å®‰è£…ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ brew install kustomize</code></pre></div>
<p>å½“ç„¶å¦‚æœä½ ä½¿ç”¨çš„æ˜¯å…¶ä»–æ“ä½œç³»ç»Ÿï¼Œé‚£ä¹ˆå°±å¯ä»¥ç›´æ¥ä» <a href="https://github.com/Kubernetes-sigs/kustomize/blob/master/docs/INSTALL.md">Release é¡µé¢</a>ä¸Šé¢ä¸‹è½½äºŒè¿›åˆ¶æ–‡ä»¶ç„¶åæ·»åˆ° PATH è·¯å¾„ä¸‹é¢å³å¯ã€‚å½“ç„¶å¦‚æœä½ æ„¿æ„ä¹Ÿå¯ä»¥ä»æºç ä¸­ç›´æ¥æ„å»ºï¼Œä»£ç ä»“åº“ï¼š<a href="https://github.com/Kubernetes-sigs/kustomize">https://github.com/Kubernetes-sigs/kustomize</a>ã€‚</p>

<h2 id="åŸºç¡€æ¨¡æ¿">åŸºç¡€æ¨¡æ¿</h2>

<p>è¦ä½¿ç”¨ Kustomizeï¼Œä½ éœ€è¦æœ‰ä¸€ä¸ªåŸå§‹çš„ yaml æ–‡ä»¶æ¥æè¿°ä½ æƒ³è¦éƒ¨ç½²åˆ°é›†ç¾¤ä¸­çš„ä»»ä½•èµ„æºï¼Œæˆ‘ä»¬è¿™é‡Œå°†è¿™äº› base æ–‡ä»¶å­˜å‚¨åœ¨<code>./k8s/base/</code>æ–‡ä»¶å¤¹ä¸‹é¢ã€‚</p>

<p>è¿™äº›æ–‡ä»¶æˆ‘ä»¬<strong>æ°¸è¿œ</strong>ä¸ä¼šç›´æ¥è®¿é—®ï¼Œæˆ‘ä»¬å°†åœ¨å®ƒä»¬ä¸Šé¢æ·»åŠ ä¸€äº›è‡ªå®šä¹‰çš„é…ç½®æ¥åˆ›å»ºæ–°çš„èµ„æºå®šä¹‰ã€‚</p>

<blockquote>
<p>ä½ å¯ä»¥åœ¨ä»»ä½•æ—¶é—´ç‚¹ä½¿ç”¨<code>kubectl apply -f ./k8s/base/</code>å‘½ä»¤æ¥æ„å»ºåŸºç¡€æ¨¡æ¿ã€‚</p>
</blockquote>

<p>ä¸‹é¢ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ Service å’Œ Deployment èµ„æºå¯¹è±¡ä¸ºä¾‹è¿›è¡Œè¯´æ˜ã€‚ä¸‹é¢å®šä¹‰ä¸¤ä¸ªèµ„æºæ¸…å•æ–‡ä»¶ï¼š
service.yaml å®šä¹‰å¦‚ä¸‹:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion: v1
kind: Service
metadata:
  name: sl-demo-app
spec:
  ports:
    - name: http
      port: <span style="color:#bd93f9">8080</span>
  selector:
    app: sl-demo-app</code></pre></div>
<p>deployment.yaml å®šä¹‰å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion: apps/v1
kind: Deployment
metadata:
  name: sl-demo-app
spec:
  selector:
    matchLabels:
      app: sl-demo-app
  template:
    metadata:
      labels:
        app: sl-demo-app
    spec:
      containers:
      - name: app
        image: foo/bar:latest
        ports:
        - name: http
          containerPort: <span style="color:#bd93f9">8080</span>
          protocol: TCP</code></pre></div>
<p>ç„¶ååœ¨å½“å‰æ–‡ä»¶å¤¹ä¸‹é¢æ·»åŠ ä¸€ä¸ªåä¸º<code>kustomization.yaml</code>çš„æ–‡ä»¶ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

resources:
  - service.yaml
  - deployment.yaml</code></pre></div>
<p>è¿™ä¸ªæ–‡ä»¶å°†æ˜¯ä½ çš„åŸºç¡€é…ç½®æ–‡ä»¶ï¼Œå®ƒæè¿°äº†ä½ ä½¿ç”¨çš„èµ„æºæ–‡ä»¶ã€‚</p>

<blockquote>
<p>å½“ä½ è¿è¡Œ<code>kubectl apply -f ./k8s/base/</code>å‘½ä»¤æ—¶ï¼Œè¯¥<code>kustomization.yaml</code>æ–‡ä»¶å¯èƒ½ä¼šå‡ºç°ä¸€äº›é”™è¯¯ï¼Œä½ å¯ä»¥æ·»åŠ å‚æ•°<code>--validate=false</code>è¿›è¡Œæ ¡éªŒï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä¸é’ˆå¯¹æ•´ä¸ªæ–‡ä»¶å¤¹è¿è¡Œè¯¥å‘½ä»¤ã€‚</p>
</blockquote>

<p>è¦å°†åŸºç¡€æ¨¡æ¿ä¸­çš„èµ„æºå®‰è£…åˆ°ä½ çš„é›†ç¾¤ä¸­ï¼Œåªéœ€è¦æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å³å¯ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl apply -k k8s/base
service/sl-demo-app created
deployment.apps/sl-demo-app created</code></pre></div>
<p>ä¸ºäº†äº†è§£å°†å®‰è£…ä»€ä¹ˆèµ„æºåˆ°é›†ç¾¤ä¸­ï¼Œæˆ‘ä»¬åœ¨æœ¬æ–‡ä¸­ä¸»è¦ä½¿ç”¨<code>kustomize build</code>å‘½ä»¤æ¥ä»£æ›¿<code>kubectl apply -k</code>å‘½ä»¤ã€‚å½“ç„¶ä½¿ç”¨<code>kubectl kustomize</code>å‘½ä»¤ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œå› ä¸ºæˆ‘ä»¬è¯´äº† kubectl 1.14 ç‰ˆæœ¬ä»¥åå°±å·²ç»é›†æˆäº† kustomizeã€‚
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-5376999672787220"
     data-ad-slot="9165834656"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

ä½¿ç”¨<code>kustomize build</code>å‘½ä»¤è¿è¡Œåçš„ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°ä¸¤ä¸ªæ–‡ä»¶è¿æ¥åœ¨ä¸€èµ·ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kustomize build k8s/base
apiVersion: v1
kind: Service
metadata:
  name: sl-demo-app
spec:
  ports:
  - name: http
    port: <span style="color:#bd93f9">8080</span>
  selector:
    app: sl-demo-app
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: sl-demo-app
spec:
  selector:
    matchLabels:
      app: sl-demo-app
  template:
    metadata:
      labels:
        app: sl-demo-app
    spec:
      containers:
      - image: foo/bar:latest
        name: app
        ports:
        - containerPort: <span style="color:#bd93f9">8080</span>
          name: http
          protocol: TCP</code></pre></div>
<h2 id="å®šåˆ¶">å®šåˆ¶</h2>

<p>ç°åœ¨æˆ‘ä»¬æƒ³è¦é’ˆå¯¹ä¸€äº›ç‰¹å®šåœºæ™¯è¿›è¡Œå®šåˆ¶ï¼Œæ¯”å¦‚ï¼Œé’ˆå¯¹ç”Ÿäº§ç¯å¢ƒå’Œæµ‹è¯•ç¯å¢ƒéœ€è¦ç”±ä¸åŒçš„é…ç½®ã€‚æˆ‘ä»¬è¿™é‡Œå¹¶ä¸ä¼šæ¶µç›– Kustomize çš„æ•´ä¸ªåŠŸèƒ½é›†ï¼Œè€Œæ˜¯ä½œä¸ºä¸€ä¸ªæ ‡å‡†ç¤ºä¾‹ï¼Œå‘ä½ å±•ç¤ºè¿™ä¸ªå·¥å…·èƒŒåçš„å“²å­¦ã€‚</p>

<p>é¦–å…ˆæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹<code>k8s/overlays/prod</code>ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªåä¸º<code>kustomzization.yaml</code>çš„æ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

bases:
- ../../base</code></pre></div>
<p>å½“å‰æ–‡ä»¶å¤¹ä¸‹é¢çš„ç›®å½•ç»“æ„å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ tree
.
â””â”€â”€ k8s
    â”œâ”€â”€ base
    â”‚Â Â  â”œâ”€â”€ deployment.yaml
    â”‚Â Â  â”œâ”€â”€ kustomization.yaml
    â”‚Â Â  â””â”€â”€ service.yaml
    â””â”€â”€ overlays
        â””â”€â”€ prod
            â””â”€â”€ kustomization.yaml</code></pre></div>
<p>å¦‚æœç°åœ¨æˆ‘ä»¬æ„å»ºè¿™ä¸ªæ–‡ä»¶ï¼Œå°†ä¼šçœ‹åˆ°å’Œä¹‹å‰æ„å»º base ç›®å½•ä¸€æ ·çš„ç»“æœï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kustomzie build k8s/overlays/prod
apiVersion: v1
kind: Service
metadata:
  name: sl-demo-app
spec:
  ports:
  - name: http
    port: <span style="color:#bd93f9">8080</span>
  selector:
    app: sl-demo-app
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: sl-demo-app
spec:
  selector:
    matchLabels:
      app: sl-demo-app
  template:
    metadata:
      labels:
        app: sl-demo-app
    spec:
      containers:
      - image: foo/bar:latest
        name: app
        ports:
        - containerPort: <span style="color:#bd93f9">8080</span>
          name: http
          protocol: TCP</code></pre></div>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥ä¸ºæˆ‘ä»¬çš„<code>prod</code>ç¯å¢ƒè¿›è¡Œä¸€äº›å®šåˆ¶ã€‚</p>

<h3 id="å®šä¹‰ç¯å¢ƒå˜é‡">å®šä¹‰ç¯å¢ƒå˜é‡</h3>

<p>åœ¨ base åŸºç¡€æ¨¡æ¿ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰ä»»ä½•ç¯å¢ƒå˜é‡ï¼Œç°åœ¨æˆ‘ä»¬éœ€è¦æ·»åŠ ä¸€äº›ç¯å¢ƒå˜é‡åœ¨ä¹‹å‰çš„åŸºç¡€æ¨¡æ¿ä¸­ã€‚å®é™…ä¸Šå¾ˆç®€å•ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨æˆ‘ä»¬çš„åŸºç¡€æ¨¡æ¿ä¸Šåˆ›å»ºä¸€å—æˆ‘ä»¬æƒ³è¦æ¨¡æ¿åŒ–çš„ä»£ç å—ï¼Œç„¶åå°†å…¶å¼•ç”¨åˆ°<code>kustomization.yaml</code>æ–‡ä»¶ä¸­å³å¯ã€‚</p>

<p>æ¯”å¦‚æˆ‘ä»¬è¿™é‡Œå®šä¹‰ä¸€ä¸ªåŒ…å«ç¯å¢ƒå˜é‡çš„é…ç½®æ–‡ä»¶ï¼š(custom-env.yaml)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion: apps/v1
kind: Deployment
metadata:
  name: sl-demo-app
spec:
  template:
    spec:
      containers:
        - name: app <span style="color:#6272a4"># (1)</span>
          env:
            - name: CUSTOM_ENV_VARIABLE
              value: Value defined by Kustomize â¤ï¸</code></pre></div>
<blockquote>
<p>æ³¨æ„ (1) è¿™é‡Œå®šä¹‰çš„ name æ˜¯éå¸¸é‡è¦çš„ï¼Œkustomize ä¼šé€šè¿‡è¯¥å€¼æ‰¾åˆ°éœ€è¦ä¿®æ”¹çš„å®¹å™¨ã€‚</p>
</blockquote>

<p>è¿™ä¸ª yaml æ–‡ä»¶æœ¬èº«æ˜¯æ— æ•ˆçš„ï¼Œå®ƒåªæè¿°äº†æˆ‘ä»¬å¸Œæœ›åœ¨ä¸Šé¢çš„åŸºç¡€æ¨¡æ¿ä¸Šæ·»åŠ çš„å†…å®¹ã€‚æˆ‘ä»¬åªéœ€è¦å°†è¿™ä¸ªæ–‡ä»¶æ·»åŠ åˆ°<code>k8s/overlays/prod/kustomization.yaml</code>æ–‡ä»¶ä¸­å³å¯ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

bases:
- ../../base

patchesStrategicMerge:
- custom-env.yaml</code></pre></div>
<p>ç°åœ¨å¦‚æœæˆ‘ä»¬æ¥æ„å»ºä¸‹ï¼Œå¯ä»¥çœ‹åˆ°å¦‚ä¸‹çš„è¾“å‡ºç»“æœï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kustomize build k8s/overlays/prod
apiVersion: v1
kind: Service
metadata:
  name: sl-demo-app
spec:
  ports:
  - name: http
    port: <span style="color:#bd93f9">8080</span>
  selector:
    app: sl-demo-app
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: sl-demo-app
spec:
  selector:
    matchLabels:
      app: sl-demo-app
  template:
    metadata:
      labels:
        app: sl-demo-app
    spec:
      containers:
      - env:
        - name: CUSTOM_ENV_VARIABLE
          value: Value defined by Kustomize â¤ï¸
        image: foo/bar:latest
        name: app
        ports:
        - containerPort: <span style="color:#bd93f9">8080</span>
          name: http
          protocol: TCP</code></pre></div>
<p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„ env å—å·²ç»è¢«åˆå¹¶åˆ°äº†æˆ‘ä»¬çš„åŸºç¡€æ¨¡æ¿ä¸Šäº†ï¼Œè‡ªå®šä¹‰çš„ env å˜é‡å‡ºç°åœ¨äº† deployment.yaml æ–‡ä»¶ä¸­ã€‚</p>

<h3 id="ä¿®æ”¹å‰¯æœ¬æ•°é‡">ä¿®æ”¹å‰¯æœ¬æ•°é‡</h3>

<p>å’Œä¸Šé¢çš„ä¾‹å­ä¸€æ ·ï¼Œæˆ‘ä»¬æ¥æ‰©å±•æˆ‘ä»¬çš„åŸºç¡€æ¨¡æ¿æ¥å®šä¹‰ä¸€äº›è¿˜æ²¡æœ‰å®šä¹‰çš„å˜é‡ã€‚</p>

<blockquote>
<p>ä½ ä¹Ÿå¯ä»¥è¦†ç›–ä¸€äº›åœ¨ base æ–‡ä»¶ä¸­å·²æœ‰çš„å˜é‡ã€‚</p>
</blockquote>

<p>è¿™é‡Œæˆ‘ä»¬æ¥æ·»åŠ ä¸€äº›å…³äºå‰¯æœ¬çš„ä¿¡æ¯ï¼Œå’Œå‰é¢ä¸€æ ·ï¼Œåªéœ€è¦åœ¨ä¸€ä¸ª YAML æ–‡ä»¶ä¸­å®šä¹‰å‰¯æœ¬æ‰€éœ€çš„é¢å¤–ä¿¡æ¯å—ï¼Œæ–°å»ºä¸€ä¸ªåä¸º<code>replica-and-rollout-strategy.yaml</code> çš„æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion: apps/v1
kind: Deployment
metadata:
  name: sl-demo-app
spec:
  replicas: <span style="color:#bd93f9">10</span>
  strategy:
    rollingUpdate:
      maxSurge: <span style="color:#bd93f9">1</span>
      maxUnavailable: <span style="color:#bd93f9">1</span>
    type: RollingUpdate</code></pre></div>
<p>å’Œå‰é¢ä¸€æ ·ï¼Œåœ¨<code>kustomization.yaml</code>æ–‡ä»¶ä¸­çš„<code>patchesStrategicMerge</code>ä¸‹é¢æ·»åŠ è¿™é‡Œå®šåˆ¶çš„æ•°æ®ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

bases:
- ../../base

patchesStrategicMerge:
- custom-env.yaml
- replica-and-rollout-strategy.yaml</code></pre></div>
<p>åŒæ ·ï¼Œè¿™ä¸ªæ—¶å€™å†ä½¿ç”¨<code>kustomize build</code>å‘½ä»¤æ„å»ºï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kustomize build k8s/overlays/prod
apiVersion: v1
kind: Service
metadata:
  name: sl-demo-app
spec:
  ports:
  - name: http
    port: <span style="color:#bd93f9">8080</span>
  selector:
    app: sl-demo-app
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: sl-demo-app
spec:
  replicas: <span style="color:#bd93f9">10</span>
  selector:
    matchLabels:
      app: sl-demo-app
  strategy:
    rollingUpdate:
      maxSurge: <span style="color:#bd93f9">1</span>
      maxUnavailable: <span style="color:#bd93f9">1</span>
    type: RollingUpdate
  template:
    metadata:
      labels:
        app: sl-demo-app
    spec:
      containers:
      - env:
        - name: CUSTOM_ENV_VARIABLE
          value: Value defined by Kustomize â¤ï¸
        image: foo/bar:latest
        name: app
        ports:
        - containerPort: <span style="color:#bd93f9">8080</span>
          name: http
          protocol: TCP</code></pre></div>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å‰¯æœ¬æ•°é‡å’Œæ»šåŠ¨æ›´æ–°çš„ç­–ç•¥éƒ½æ·»åŠ åˆ°äº†åŸºç¡€æ¨¡æ¿ä¹‹ä¸Šäº†ã€‚</p>

<h3 id="é€šè¿‡å‘½ä»¤è¡Œå®šä¹‰-secret">é€šè¿‡å‘½ä»¤è¡Œå®šä¹‰ secret</h3>

<p>æˆ‘ä»¬å¸¸å¸¸ä¼šé€šè¿‡å‘½ä»¤è¡Œæ¥æ·»åŠ ä¸€ä¸ª secret å¯¹è±¡ï¼Œ<code>kustomize</code>æœ‰ä¸€ä¸ª<code>edit</code>çš„å­å‘½ä»¤å¯ä»¥ç”¨æ¥ç¼–è¾‘<code>kustomization.yaml</code>æ–‡ä»¶ç„¶ååˆ›å»ºä¸€ä¸ª secret å¯¹è±¡ï¼Œæ¯”å¦‚æˆ‘ä»¬è¿™é‡Œæ·»åŠ ä¸€ä¸ªå¦‚ä¸‹æ‰€ç¤ºçš„ secret å¯¹è±¡ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ <span style="color:#8be9fd;font-style:italic">cd</span> k8s/overlays/prod
$ kustomize edit add secret sl-demo-app --from-literal<span style="color:#ff79c6">=</span>db-password<span style="color:#ff79c6">=</span><span style="color:#bd93f9">12345</span></code></pre></div>
<p>ä¸Šé¢çš„å‘½ä»¤ä¼šä¿®æ”¹<code>kustomization.yaml</code>æ–‡ä»¶æ·»åŠ ä¸€ä¸ª<code>SecretGenerator</code>å­—æ®µåœ¨é‡Œé¢ã€‚</p>

<blockquote>
<p>å½“ç„¶ä½ ä¹Ÿå¯ä»¥é€šè¿‡æ–‡ä»¶ï¼ˆæ¯”å¦‚<code>--from-file=file/path</code>æˆ–è€…<code>--from-evn-file=env/path.env</code>ï¼‰æ¥åˆ›å»º secret å¯¹è±¡ã€‚</p>
</blockquote>

<p>é€šè¿‡ä¸Šé¢å‘½ä»¤åˆ›å»ºå®Œ secret å¯¹è±¡åï¼Œ<code>kustomization.yaml</code>æ–‡ä»¶çš„å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

bases:
- ../../base

patchesStrategicMerge:
- custom-env.yaml
- replica-and-rollout-strategy.yaml
secretGenerator:
- literals:
  - db-password=<span style="color:#bd93f9">12345</span>
  name: sl-demo-app
  type: Opaque</code></pre></div>
<p>ç„¶ååŒæ ·çš„æˆ‘ä»¬å›åˆ°æ ¹ç›®å½•ä¸‹é¢æ‰§è¡Œ<code>kustomize build</code>å‘½ä»¤æ„å»ºä¸‹æ¨¡æ¿ï¼Œè¾“å‡ºå†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kustomize build k8s/overlays/prod
apiVersion: v1
data:
  db-password: <span style="color:#8be9fd;font-style:italic">MTIzNDU</span><span style="color:#ff79c6">=</span>
kind: Secret
metadata:
  name: sl-demo-app-6ft88t2625
type: Opaque
---
apiVersion: v1
kind: Service
metadata:
  name: sl-demo-app
spec:
  ports:
  - name: http
    port: <span style="color:#bd93f9">8080</span>
  selector:
    app: sl-demo-app
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: sl-demo-app
spec:
  replicas: <span style="color:#bd93f9">10</span>
  selector:
    matchLabels:
      app: sl-demo-app
  strategy:
    rollingUpdate:
      maxSurge: <span style="color:#bd93f9">1</span>
      maxUnavailable: <span style="color:#bd93f9">1</span>
    type: RollingUpdate
  template:
    metadata:
      labels:
        app: sl-demo-app
    spec:
      containers:
      - env:
        - name: CUSTOM_ENV_VARIABLE
          value: Value defined by Kustomize â¤ï¸
        image: foo/bar:latest
        name: app
        ports:
        - containerPort: <span style="color:#bd93f9">8080</span>
          name: http
          protocol: TCP</code></pre></div>
<blockquote>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ° secret å¯¹è±¡çš„åç§°æ˜¯<code>sl-demo-app-6ft88t2625</code>ï¼Œè€Œä¸æ˜¯æˆ‘ä»¬å®šä¹‰çš„<code>sl-demo-app</code>ï¼Œè¿™æ˜¯æ­£å¸¸çš„ï¼Œå› ä¸ºå¦‚æœæ›´æ”¹äº† secret å†…å®¹ï¼Œå°±å¯ä»¥è§¦å‘æ»šåŠ¨æ›´æ–°äº†ã€‚</p>
</blockquote>

<p>åŒæ ·çš„ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦åœ¨ Deployment ä¸­ä½¿ç”¨è¿™ä¸ª Secret å¯¹è±¡ï¼Œæˆ‘ä»¬å°±å¯ä»¥åƒä¹‹å‰ä¸€æ ·æ·»åŠ ä¸€ä¸ªä½¿ç”¨ Secret çš„æ–°çš„å±‚å®šä¹‰å³å¯ã€‚</p>

<p>æ¯”å¦‚æˆ‘ä»¬è¿™é‡ŒåƒæŠŠ<code>db-password</code>çš„å€¼é€šè¿‡ç¯å¢ƒå˜é‡æ³¨å…¥åˆ° Deployment ä¸­ï¼Œæˆ‘ä»¬å°±å¯ä»¥å®šä¹‰ä¸‹é¢è¿™æ ·çš„æ–°çš„å±‚ä¿¡æ¯ï¼šï¼ˆdatabase-secret.yamlï¼‰</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion: apps/v1
kind: Deployment
metadata:
  name: sl-demo-app
spec:
  template:
    spec:
      containers:
      - name: app
        env:
        - name: <span style="color:#f1fa8c">&#34;DB_PASSWORD&#34;</span>
          valueFrom:
            secretKeyRef:
              name: sl-demo-app
              key: db.password</code></pre></div>
<p>ç„¶ååŒæ ·çš„ï¼Œæˆ‘ä»¬æŠŠè¿™é‡Œå®šä¹‰çš„å±‚æ·»åŠ åˆ°<code>k8s/overlays/prod/kustomization.yaml</code>æ–‡ä»¶ä¸­å»ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

bases:
- ../../base

patchesStrategicMerge:
- custom-env.yaml
- replica-and-rollout-strategy.yaml
- database-secret.yaml

secretGenerator:
- literals:
  - db-password=<span style="color:#bd93f9">12345</span>
  name: sl-demo-app
  type: Opaque</code></pre></div>
<p>ç°åœ¨æˆ‘ä»¬æ¥æ„å»ºæ•´ä¸ªçš„ prod ç›®å½•ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°å¦‚ä¸‹æ‰€ç¤ºçš„ä¿¡æ¯ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kustomize build k8s/overlays/prod
apiVersion: v1
data:
  db-password: <span style="color:#8be9fd;font-style:italic">MTIzNDU</span><span style="color:#ff79c6">=</span>
kind: Secret
metadata:
  name: sl-demo-app-6ft88t2625
type: Opaque
---
apiVersion: v1
kind: Service
metadata:
  name: sl-demo-app
spec:
  ports:
  - name: http
    port: <span style="color:#bd93f9">8080</span>
  selector:
    app: sl-demo-app
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: sl-demo-app
spec:
  replicas: <span style="color:#bd93f9">10</span>
  selector:
    matchLabels:
      app: sl-demo-app
  strategy:
    rollingUpdate:
      maxSurge: <span style="color:#bd93f9">1</span>
      maxUnavailable: <span style="color:#bd93f9">1</span>
    type: RollingUpdate
  template:
    metadata:
      labels:
        app: sl-demo-app
    spec:
      containers:
      - env:
        - name: DB_PASSWORD
          valueFrom:
            secretKeyRef:
              key: db.password
              name: sl-demo-app-6ft88t2625
        - name: CUSTOM_ENV_VARIABLE
          value: Value defined by Kustomize â¤ï¸
        image: foo/bar:latest
        name: app
        ports:
        - containerPort: <span style="color:#bd93f9">8080</span>
          name: http
          protocol: TCP</code></pre></div>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°<code>secretKeyRef.name</code>çš„å€¼ä¹ŸæŒ‡å®šçš„è¢«ä¿®æ”¹æˆäº†ä¸Šé¢ç”Ÿæˆçš„ secret å¯¹è±¡çš„åç§°ã€‚</p>

<blockquote>
<p>ç”±äº Secret æ˜¯ä¸€äº›ç§å¯†çš„ä¿¡æ¯ï¼Œæ‰€ä»¥æœ€å¥½æ˜¯åœ¨å®‰å…¨çš„ç¯å¢ƒä¸­æ¥æ·»åŠ ä¸Šé¢çš„ secret çš„å¯¹è±¡ï¼Œè€Œä¸åº”è¯¥å’Œå…¶ä»–ä»£ç ä¹‹ç±»çš„ä¸€èµ·è¢«æäº¤åˆ°ä»£ç ä»“åº“ä¹‹ç±»çš„å»ã€‚</p>
</blockquote>

<p>å¦‚æœæ˜¯ ConfigMap çš„è¯ä¹Ÿæ˜¯åŒæ ·çš„é€»è¾‘ï¼Œæœ€åä¼šç”Ÿæˆä¸€ä¸ª hash å€¼çš„åç§°ï¼Œè¿™æ ·åœ¨ ConfigMap æ›´æ”¹æ—¶å¯ä»¥è§¦å‘é‡æ–°éƒ¨ç½²ã€‚</p>

<h3 id="ä¿®æ”¹é•œåƒ">ä¿®æ”¹é•œåƒ</h3>

<p>å’Œ secret èµ„æºå¯¹è±¡ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä»å‘½ä»¤è¡Œç›´æ¥æ›´æ”¹é•œåƒæˆ–è€… tagï¼Œå¦‚æœä½ éœ€è¦éƒ¨ç½²é€šè¿‡ CI/CD ç³»ç»Ÿæ ‡è®°çš„é•œåƒçš„è¯è¿™å°±éå¸¸æœ‰ç”¨äº†ã€‚</p>

<p>æ¯”å¦‚æˆ‘ä»¬è¿™é‡Œæ¥ä¿®æ”¹ä¸‹é•œåƒçš„ tagï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ <span style="color:#8be9fd;font-style:italic">cd</span> k8s/overlays/prod
$ <span style="color:#8be9fd;font-style:italic">TAG_VERSION</span><span style="color:#ff79c6">=</span><span style="color:#bd93f9">3</span>.4.5
$ kustomize edit <span style="color:#8be9fd;font-style:italic">set</span> image foo/bar<span style="color:#ff79c6">=</span>foo/bar:<span style="color:#8be9fd;font-style:italic">$TAG_VERSION</span></code></pre></div>
<blockquote>
<p>ä¸€èˆ¬æƒ…å†µä¸‹<code>TAG_VERSION</code>å¸¸å¸¸è¢«å®šä¹‰åœ¨ CI/CD ç³»ç»Ÿä¸­ã€‚</p>
</blockquote>

<p>ç°åœ¨çš„<code>kustomization.yaml</code>æ–‡ä»¶å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

bases:
- ../../base

patchesStrategicMerge:
- custom-env.yaml
- replica-and-rollout-strategy.yaml
- database-secret.yaml

secretGenerator:
- literals:
  - db-password=<span style="color:#bd93f9">12345</span>
  name: sl-demo-app
  type: Opaque

images:
- name: foo/bar
  newName: foo/bar
  newTag: <span style="color:#bd93f9">3.4</span>.<span style="color:#bd93f9">5</span></code></pre></div>
<p>åŒæ ·å›åˆ°æ ¹ç›®å½•ä¸‹é¢æ„å»ºè¯¥æ¨¡æ¿ï¼Œä¼šå¾—åˆ°å¦‚ä¸‹æ‰€ç¤ºçš„ä¿¡æ¯ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kustomize build k8s/overlays/prod
apiVersion: v1
data:
  db-password: <span style="color:#8be9fd;font-style:italic">MTIzNDU</span><span style="color:#ff79c6">=</span>
kind: Secret
metadata:
  name: sl-demo-app-6ft88t2625
type: Opaque
---
apiVersion: v1
kind: Service
metadata:
  name: sl-demo-app
spec:
  ports:
  - name: http
    port: <span style="color:#bd93f9">8080</span>
  selector:
    app: sl-demo-app
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: sl-demo-app
spec:
  replicas: <span style="color:#bd93f9">10</span>
  selector:
    matchLabels:
      app: sl-demo-app
  strategy:
    rollingUpdate:
      maxSurge: <span style="color:#bd93f9">1</span>
      maxUnavailable: <span style="color:#bd93f9">1</span>
    type: RollingUpdate
  template:
    metadata:
      labels:
        app: sl-demo-app
    spec:
      containers:
      - env:
        - name: DB_PASSWORD
          valueFrom:
            secretKeyRef:
              key: db.password
              name: sl-demo-app-6ft88t2625
        - name: CUSTOM_ENV_VARIABLE
          value: Value defined by Kustomize â¤ï¸
        image: foo/bar:3.4.5
        name: app
        ports:
        - containerPort: <span style="color:#bd93f9">8080</span>
          name: http
          protocol: TCP</code></pre></div>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ° Deployment çš„ç¬¬ä¸€ä¸ª<code>container.image</code>å·²ç»è¢«ä¿®æ”¹äº† 3.4.5 ç‰ˆæœ¬äº†ã€‚</p>

<p>æœ€ç»ˆæˆ‘ä»¬å®šåˆ¶çš„æ¨¡æ¿æ–‡ä»¶ç›®å½•ç»“æ„å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ tree .
.
â””â”€â”€ k8s
    â”œâ”€â”€ base
    â”‚Â Â  â”œâ”€â”€ deployment.yaml
    â”‚Â Â  â”œâ”€â”€ kustomization.yaml
    â”‚Â Â  â””â”€â”€ service.yaml
    â””â”€â”€ overlays
        â””â”€â”€ prod
            â”œâ”€â”€ custom-env.yaml
            â”œâ”€â”€ database-secret.yaml
            â”œâ”€â”€ kustomization.yaml
            â””â”€â”€ replica-and-rollout-strategy.yaml

<span style="color:#bd93f9">4</span> directories, <span style="color:#bd93f9">7</span> files</code></pre></div>
<p>è¦å®‰è£…åˆ°é›†ç¾¤ä¸­ä¹Ÿå¾ˆç®€å•ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kustomize build k8s/overlays/prod | kubectl apply -f -</code></pre></div>
<h2 id="æ€»ç»“">æ€»ç»“</h2>

<p>åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬äº†è§£åˆ°äº†å¦‚ä½•ä½¿ç”¨ Kustomize çš„å¼ºå¤§åŠŸèƒ½æ¥å®šä¹‰ä½ çš„ Kuberentes èµ„æºæ¸…å•æ–‡ä»¶ï¼Œè€Œä¸éœ€è¦ä½¿ç”¨ä»€ä¹ˆé¢å¤–çš„æ¨¡æ¿ç³»ç»Ÿï¼Œåˆ›å»ºçš„æ‰€æœ‰çš„ä¿®æ”¹çš„å—æ–‡ä»¶éƒ½å°†è¢«åº”ç”¨åˆ°åŸå§‹åŸºç¡€æ¨¡æ¿æ–‡ä»¶ä¹‹ä¸Šï¼Œè€Œä¸ç”¨ä½¿ç”¨ä»€ä¹ˆèŠ±æ‹¬å·ä¹‹ç±»çš„ä¿®æ”¹æ¥æ›´æ”¹å®ƒï¼ˆè²Œä¼¼æ— å½¢ä¸­æœ‰é„™è§†äº†ä¸‹ Helm ğŸ˜„ï¼‰ã€‚</p>

<p>Kustomize ä¸­è¿˜æœ‰å¾ˆå¤šå…¶ä»–é«˜çº§ç”¨æ³•ï¼Œæ¯”å¦‚ mixins å’Œç»§æ‰¿æˆ–è€…å…è®¸ä¸ºæ¯ä¸€ä¸ªåˆ›å»ºçš„å¯¹è±¡å®šä¹‰ä¸€ä¸ªåç§°ã€æ ‡ç­¾æˆ–è€… namespace ç­‰ç­‰ï¼Œä½ å¯ä»¥åœ¨å®˜æ–¹çš„ <a href="https://github.com/kubernetes-sigs/kustomize">Kustomize GitHub ä»£ç ä»“åº“</a>ä¸­æŸ¥çœ‹é«˜çº§ç¤ºä¾‹å’Œæ–‡æ¡£ã€‚</p>

<p><a href="https://www.qikqiak.com/post/promotion-51" title="ä» Docker åˆ° Kubernetes è¿›é˜¶è¯¾ç¨‹"><img src="https://bxdc-static.oss-cn-beijing.aliyuncs.com/images/9mogk.png" alt="kubernetesè¿›é˜¶è¯¾ç¨‹"></a></p>


<h2 id="å‚è€ƒæ–‡æ¡£">å‚è€ƒæ–‡æ¡£</h2>

<ul>
<li><a href="https://github.com/kubernetes-sigs/kustomize">Kustomize GitHub</a></li>
<li><a href="https://blog.stack-labs.com/code/kustomize-101/">Kustomize - The right way to do templating in Kubernetes</a></li>
<li><a href="https://www.exoscale.com/syslog/kubernetes-kustomize/">Configuring Kubernetes Applications with kustomize</a></li>
</ul>

          <h2>å¾®ä¿¡å…¬ä¼—å·</h2>
<p>æ‰«æä¸‹é¢çš„äºŒç»´ç å…³æ³¨æˆ‘ä»¬çš„å¾®ä¿¡å…¬ä¼—å¸å·ï¼Œåœ¨å¾®ä¿¡å…¬ä¼—å¸å·ä¸­å›å¤â—‰åŠ ç¾¤â—‰å³å¯åŠ å…¥åˆ°æˆ‘ä»¬çš„ kubernetes è®¨è®ºç¾¤é‡Œé¢å…±åŒå­¦ä¹ ã€‚</p>
<img src="https://bxdc-static.oss-cn-beijing.aliyuncs.com/images/qrcode.png" alt="wechat-account-qrcode">

  
          
            <div class="entry-shang text-center">
    <p>ã€ŒçœŸè¯šèµèµï¼Œæ‰‹ç•™ä½™é¦™ã€</p>
    <button class="zs show-zs btn btn-bred">èµèµ</button>
</div>
<div class="zs-modal-bg"></div>
<div class="zs-modal-box">
    <div class="zs-modal-head">
        <button type="button" class="close">Ã—</button>
        <span class="author"><img src="https://www.qikqiak.com/img/avatar.jpeg"/>é˜³æ˜</span>
        <p class="tip"><i></i><span>è¯·æˆ‘å–æ¯å’–å•¡ï¼Ÿ</span></p>
    </div>
    <div class="zs-modal-body">
        <div class="zs-modal-btns">
            <button class="btn btn-blink" data-num="2">2å…ƒ</button>
            <button class="btn btn-blink" data-num="5">5å…ƒ</button>
            <button class="btn btn-blink" data-num="10">10å…ƒ</button>
            <button class="btn btn-blink" data-num="50">50å…ƒ</button>
            <button class="btn btn-blink" data-num="100">100å…ƒ</button>
            <button class="btn btn-blink" data-num="1">ä»»æ„é‡‘é¢</button>
        </div>
        <div class="zs-modal-pay">
            <button class="btn btn-bred" id="pay-text">2å…ƒ</button>
            <p>ä½¿ç”¨<span id="pay-type">å¾®ä¿¡</span>æ‰«æäºŒç»´ç å®Œæˆæ”¯ä»˜</p>
            <img src="https://www.qikqiak.com/img/wechat-2.png" id="pay-image"/>
        </div>
    </div>
    <div class="zs-modal-footer">
        <span class="zs-wechat"><img src="https://www.qikqiak.com/img/wechat-btn.png"/></span>
    </div>
</div>
          
          
            <div class="social-share" data-initialized="true" style="margin-bottom: 20px;margin-top:20px;">
    <center>
    <a href="#" class="social-share-icon icon-weibo"></a>
    <a href="#" class="social-share-icon icon-wechat"></a>
    <a href="#" class="social-share-icon icon-twitter"></a>
    <a href="#" class="social-share-icon icon-linkedin"></a>
    <a href="#" class="social-share-icon icon-facebook"></a>
    <a href="#" class="social-share-icon icon-qq"></a>
    <a href="#" class="social-share-icon icon-qzone"></a>
    </center>
</div>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script>

          
        </article>
  
        
          

<h3>ç›¸å…³æ–‡ç« </h3>
<ul style="margin-bottom: 25px;">
    
    <li><a href="https://www.qikqiak.com/post/helm-chart-tips-and-tricks/">Helm Chart æ¨¡æ¿å¼€å‘æŠ€å·§</a></li>
    
    <li><a href="https://www.qikqiak.com/post/helm-name-template-usage/">Helm å‘½åæ¨¡æ¿çš„ä½¿ç”¨</a></li>
    
    <li><a href="https://www.qikqiak.com/post/drone-with-k8s-3/">Drone ç»“åˆ Helm éƒ¨ç½² Kubernetes åº”ç”¨</a></li>
    
    <li><a href="https://www.qikqiak.com/post/drone-with-k8s-2/">ä½¿ç”¨ Drone Pipeline æ„å»º Docker é•œåƒ</a></li>
    
    <li><a href="https://www.qikqiak.com/post/drone-with-k8s-1/">ä½¿ç”¨ Kubernetes Helm å®‰è£… Drone</a></li>
    
    <li><a href="https://www.qikqiak.com/post/install-nginx-ingress/">nginx-ingress çš„å®‰è£…ä½¿ç”¨</a></li>
    
    <li><a href="https://www.qikqiak.com/post/helm-hooks-usage/">Helm Hooks çš„ä½¿ç”¨</a></li>
    
    <li><a href="https://www.qikqiak.com/post/kubernetes-helm-usage/">Helm çš„åŸºæœ¬ä½¿ç”¨</a></li>
    
    <li><a href="https://www.qikqiak.com/post/first-use-helm-on-kubernetes/">Kubernetes Helm åˆä½“éªŒ</a></li>
    
    <li><a href="https://www.qikqiak.com/post/install-kubesphere-on-k8s/">åœ¨ç°æœ‰ Kubernetes é›†ç¾¤ä¸Šå®‰è£… KubeSphere</a></li>
    
</ul>

        
  
        
        <ul class="pager blog-pager">
          
            <li class="previous">
              <a href="https://www.qikqiak.com/post/install-kubesphere-on-k8s/" data-toggle="tooltip" data-placement="top" title="åœ¨ç°æœ‰ Kubernetes é›†ç¾¤ä¸Šå®‰è£… KubeSphere">&larr; å‰ä¸€ç¯‡</a>
            </li>
          
          
            <li class="next">
              <a href="https://www.qikqiak.com/post/use-github-actions-build-go-app/" data-toggle="tooltip" data-placement="top" title="ä½¿ç”¨ GitHub Actions è‡ªåŠ¨åŒ–æ„å»º Golang åº”ç”¨">åä¸€ç¯‡ &rarr;</a>
            </li>
          
        </ul>
        
  
        
    <div id="gitalk-container"></div>
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>
    var gitalk = new Gitalk({
        clientID: 'bdb76dbb2e9d0786e350',
        clientSecret: 'b454b2a08013fd0e32013be7a63fa8fcb262b6c4',
        repo: 'blog',
        owner: 'cnych',
        admin: ['cnych'],
        labels: ['gitment'],
        title: 'ä½¿ç”¨ Kustomize é…ç½® Kubernetes åº”ç”¨',
        createIssueManually: true,
        id: 'kustomize-101',      
        distractionFreeMode: true  
    });
    gitalk.render('gitalk-container');
</script>

  
      </div>
    
    
  </div>
</div>

    <footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          <img src="https://www.qikqiak.com/img/wechatmp.png" alt="k8sæŠ€æœ¯åœˆ">
          
              <li>
                <a href="mailto:icnych@gmail.com" title="Email me">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
              <li>
                <a href="https://github.com/cnych" title="GitHub">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
              <li>
                <a href="https://weibo.com/cnych" title="å¾®åš">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-weibo fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
              <li>
                <a href="https://instagram.com/cnych" title="Instagram">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-instagram fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
          
          <li>
            <a href="https://www.qikqiak.com/index.xml" title="RSS">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
        </ul>
        <p class="credits copyright text-muted">
          

          &nbsp;&bull;&nbsp;
          2019

          
            &nbsp;&bull;&nbsp;
            <a href="https://www.qikqiak.com/">é˜³æ˜çš„åšå®¢</a>
            &nbsp;&bull;&nbsp;
            <a href="https://www.qikqiak.com/sitemap.xml">ç½‘ç«™åœ°å›¾</a>
            &nbsp;&bull;&nbsp;
            <a href="https://www.qikqiak.com/page/archive/">æ–‡ç« å½’æ¡£</a>
            &nbsp;&bull;&nbsp;
            <a href="https://www.qikqiak.com/page/friend/">å‹é“¾</a>
            &nbsp;&bull;&nbsp;
            
            <a class="h" href="https://www.qikqiak.com/page/kubernetes.io">kubernetes.io</a>
            <a class="h" href="https://www.qikqiak.com/page/kubernetes.org.cn">Kubernetesä¸­æ–‡ç¤¾åŒº</a>
          
        </p>
        <p class="text-center text-muted">
          <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
          <span id="busuanzi_container_site_pv" style="display:none">
            æœ¬ç«™æ€»è®¿é—®é‡<span id="busuanzi_value_site_pv"></span>æ¬¡
          </span>
          &nbsp;&bull;&nbsp;
          <span id="busuanzi_container_site_uv" style="display:none">
            è®¿å®¢æ•°<span id="busuanzi_value_site_uv"></span>äººæ¬¡
          </span>
        </p>
        
        <p class="credits theme-by text-muted">
          ç”± <a href="http://gohugo.io">Hugo v0.53</a> å¼ºåŠ›é©±åŠ¨ &nbsp;&bull;&nbsp; ä¸»é¢˜ <a href="https://github.com/cnych/qikqiak.com">qikqiak-blog</a> ç§»æ¤è‡ª <a href="https://github.com/rootsongjc/beautifulhugo">Beautiful Hugo</a>
          
        </p>
      </div>
    </div>
  </div>
</footer>



<script src='https://www.qikqiak.com/js/bundle.min.8242ab5c3c016acc49d8c7717b5c1a9f24511d0b9e5d1c0e44f2b907c76b5987.js' integrity='sha256-gkKrXDwBasxJ2Mdxe1wanyRRHQueXRwORPK5B8drWYc='></script>




<script async src="https://www.googletagmanager.com/gtag/js?id=UA-69668147-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-69668147-3');
</script>
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<script >
$(document).ready(function() {
  var int = setInterval(fixCount, 50);  
  
  var initPVCount = 584976;
  var initUVCount = 153191;
  function fixCount() {                   
    if ($("#busuanzi_container_site_pv").css("display") != "none") {
        $("#busuanzi_value_site_pv").html(parseInt($("#busuanzi_value_site_pv").html()) + initPVCount); 
        clearInterval(int); 
    }
    if ($("#busuanzi_container_site_uv").css("display") != "none") {
      $("#busuanzi_value_site_uv").html(parseInt($("#busuanzi_value_site_uv").html()) + initUVCount);
      clearInterval(int); 
    }  
  }           
});
</script>

  </body>
</html>

